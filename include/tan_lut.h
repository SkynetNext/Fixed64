#pragma once

#include <stdint.h>
#include <array>
#include "primitives.h"

// Tan lookup table with 512 entries
// Covers the range [0,pi/2] with values in Q23.40 format
// Generated with mpmath library at 100 digits precision

namespace math::fp::detail {
// Table maps x in [0,pi/2] to tan(x)
// Values stored in Q23.40 fixed-point format
inline constexpr std::array<int64_t, 512> kTanLut = {
    0x0000000000000000LL, // tan(0.00000000000) = 0.00000000000
    0x00000000C974BE82LL, // tan(0.00307396541) = 0.00307397510
    0x0000000192EA7688LL, // tan(0.00614793083) = 0.00614800829
    0x000000025C62219ALL, // tan(0.00922189624) = 0.00922215767
    0x0000000325DCB94ALL, // tan(0.01229586166) = 0.01229648136
    0x00000003EF5B3739LL, // tan(0.01536982707) = 0.01537103747
    0x00000004B8DE951ALL, // tan(0.01844379249) = 0.01844588413
    0x000000058267CCBALL, // tan(0.02151775790) = 0.02152107952
    0x000000064BF7D802LL, // tan(0.02459172332) = 0.02459668182
    0x00000007158FB0FCLL, // tan(0.02766568873) = 0.02767274924
    0x00000007DF3051DALL, // tan(0.03073965414) = 0.03074934004
    0x00000008A8DAB4FALL, // tan(0.03381361956) = 0.03382651251
    0x00000009728FD4E8LL, // tan(0.03688758497) = 0.03690432499
    0x0000000A3C50AC69LL, // tan(0.03996155039) = 0.03998283586
    0x0000000B061E3678LL, // tan(0.04303551580) = 0.04306210356
    0x0000000BCFF96E52LL, // tan(0.04610948122) = 0.04614218658
    0x0000000C99E34F76LL, // tan(0.04918344663) = 0.04922314348
    0x0000000D63DCD5AFLL, // tan(0.05225741205) = 0.05230503289
    0x0000000E2DE6FD12LL, // tan(0.05533137746) = 0.05538791350
    0x0000000EF802C208LL, // tan(0.05840534287) = 0.05847184407
    0x0000000FC2312154LL, // tan(0.06147930829) = 0.06155688347
    0x000000108C731813LL, // tan(0.06455327370) = 0.06464309061
    0x0000001156C9A3C3LL, // tan(0.06762723912) = 0.06773052452
    0x000000122135C24BLL, // tan(0.07070120453) = 0.07081924432
    0x00000012EBB871FDLL, // tan(0.07377516995) = 0.07390930922
    0x00000013B652B19BLL, // tan(0.07684913536) = 0.07700077854
    0x000000148105805CLL, // tan(0.07992310078) = 0.08009371170
    0x000000154BD1DDF3LL, // tan(0.08299706619) = 0.08318816823
    0x0000001616B8CA94LL, // tan(0.08607103161) = 0.08628420778
    0x00000016E1BB46F4LL, // tan(0.08914499702) = 0.08938189013
    0x00000017ACDA5456LL, // tan(0.09221896243) = 0.09248127517
    0x000000187816F48ALL, // tan(0.09529292785) = 0.09558242293
    0x00000019437229F6LL, // tan(0.09836689326) = 0.09868539357
    0x0000001A0EECF798LL, // tan(0.10144085868) = 0.10179024739
    0x0000001ADA88610ELL, // tan(0.10451482409) = 0.10489704485
    0x0000001BA6456A99LL, // tan(0.10758878951) = 0.10800584652
    0x0000001C72251925LL, // tan(0.11066275492) = 0.11111671318
    0x0000001D3E28724ALL, // tan(0.11373672034) = 0.11422970572
    0x0000001E0A507C56LL, // tan(0.11681068575) = 0.11734488521
    0x0000001ED69E3E51LL, // tan(0.11988465116) = 0.12046231290
    0x0000001FA312BFFFLL, // tan(0.12295861658) = 0.12358205020
    0x000000206FAF09EBLL, // tan(0.12603258199) = 0.12670415871
    0x000000213C742568LL, // tan(0.12910654741) = 0.12982870019
    0x0000002209631C98LL, // tan(0.13218051282) = 0.13295573662
    0x00000022D67CFA72LL, // tan(0.13525447824) = 0.13608533015
    0x00000023A3C2CAC8LL, // tan(0.13832844365) = 0.13921754313
    0x0000002471359A4BLL, // tan(0.14140240907) = 0.14235243813
    0x000000253ED67691LL, // tan(0.14447637448) = 0.14549007792
    0x000000260CA66E1BLL, // tan(0.14755033989) = 0.14863052548
    0x00000026DAA6905CLL, // tan(0.15062430531) = 0.15177384400
    0x00000027A8D7EDBDLL, // tan(0.15369827072) = 0.15492009691
    0x00000028773B97A2LL, // tan(0.15677223614) = 0.15806934788
    0x0000002945D2A074LL, // tan(0.15984620155) = 0.16122166078
    0x0000002A149E1BA1LL, // tan(0.16292016697) = 0.16437709975
    0x0000002AE39F1DA6LL, // tan(0.16599413238) = 0.16753572916
    0x0000002BB2D6BC16LL, // tan(0.16906809780) = 0.17069761364
    0x0000002C82460D9BLL, // tan(0.17214206321) = 0.17386281807
    0x0000002D51EE2A01LL, // tan(0.17521602862) = 0.17703140760
    0x0000002E21D02A38LL, // tan(0.17828999404) = 0.18020344764
    0x0000002EF1ED285ELL, // tan(0.18136395945) = 0.18337900386
    0x0000002FC2463FC4LL, // tan(0.18443792487) = 0.18655814225
    0x0000003092DC8CF3LL, // tan(0.18751189028) = 0.18974092904
    0x0000003163B12DB1LL, // tan(0.19058585570) = 0.19292743078
    0x0000003234C5410ELL, // tan(0.19365982111) = 0.19611771429
    0x000000330619E761LL, // tan(0.19673378653) = 0.19931184672
    0x00000033D7B04257LL, // tan(0.19980775194) = 0.20250989551
    0x00000034A98974F5LL, // tan(0.20288171736) = 0.20571192842
    0x000000357BA6A39DLL, // tan(0.20595568277) = 0.20891801352
    0x000000364E08F41CLL, // tan(0.20902964818) = 0.21212821922
    0x0000003720B18DA7LL, // tan(0.21210361360) = 0.21534261425
    0x00000037F3A198EALL, // tan(0.21517757901) = 0.21856126769
    0x00000038C6DA400ALL, // tan(0.21825154443) = 0.22178424896
    0x000000399A5CAEAFLL, // tan(0.22132550984) = 0.22501162781
    0x0000003A6E2A1207LL, // tan(0.22439947526) = 0.22824347439
    0x0000003B424398D3LL, // tan(0.22747344067) = 0.23147985917
    0x0000003C16AA7367LL, // tan(0.23054740609) = 0.23472085302
    0x0000003CEB5FD3B7LL, // tan(0.23362137150) = 0.23796652717
    0x0000003DC064ED5DLL, // tan(0.23669533691) = 0.24121695323
    0x0000003E95BAF59CLL, // tan(0.23976930233) = 0.24447220322
    0x0000003F6B632370LL, // tan(0.24284326774) = 0.24773234954
    0x00000040415EAF8BLL, // tan(0.24591723316) = 0.25099746500
    0x0000004117AED467LL, // tan(0.24899119857) = 0.25426762281
    0x00000041EE54CE46LL, // tan(0.25206516399) = 0.25754289661
    0x00000042C551DB3CLL, // tan(0.25513912940) = 0.26082336047
    0x000000439CA73B39LL, // tan(0.25821309482) = 0.26410908886
    0x000000447456300ELL, // tan(0.26128706023) = 0.26740015672
    0x000000454C5FFD78LL, // tan(0.26436102564) = 0.27069663943
    0x0000004624C5E923LL, // tan(0.26743499106) = 0.27399861280
    0x00000046FD893ABALL, // tan(0.27050895647) = 0.27730615314
    0x00000047D6AB3BE7LL, // tan(0.27358292189) = 0.28061933720
    0x00000048B02D3861LL, // tan(0.27665688730) = 0.28393824221
    0x000000498A107DF2LL, // tan(0.27973085272) = 0.28726294589
    0x0000004A64565C82LL, // tan(0.28280481813) = 0.29059352644
    0x0000004B3F00261BLL, // tan(0.28587878355) = 0.29393006258
    0x0000004C1A0F2EF7LL, // tan(0.28895274896) = 0.29727263352
    0x0000004CF584CD85LL, // tan(0.29202671437) = 0.30062131899
    0x0000004DD1625A76LL, // tan(0.29510067979) = 0.30397619923
    0x0000004EADA930C2LL, // tan(0.29817464520) = 0.30733735505
    0x0000004F8A5AADB2LL, // tan(0.30124861062) = 0.31070486775
    0x00000050677830ECLL, // tan(0.30432257603) = 0.31407881922
    0x0000005145031C7ALL, // tan(0.30739654145) = 0.31745929189
    0x0000005222FCD4D4LL, // tan(0.31047050686) = 0.32084636875
    0x000000530166C0EBLL, // tan(0.31354447228) = 0.32424013338
    0x00000053E0424A2FLL, // tan(0.31661843769) = 0.32764066993
    0x00000054BF90DCA0LL, // tan(0.31969240311) = 0.33104806315
    0x000000559F53E6D0LL, // tan(0.32276636852) = 0.33446239839
    0x000000567F8CD9F2LL, // tan(0.32584033393) = 0.33788376161
    0x00000057603D29E3LL, // tan(0.32891429935) = 0.34131223939
    0x0000005841664D36LL, // tan(0.33198826476) = 0.34474791894
    0x000000592309BD3BLL, // tan(0.33506223018) = 0.34819088812
    0x0000005A0528F60ELL, // tan(0.33813619559) = 0.35164123542
    0x0000005AE7C5769ELL, // tan(0.34121016101) = 0.35509905001
    0x0000005BCAE0C0BALL, // tan(0.34428412642) = 0.35856442170
    0x0000005CAE7C591ELL, // tan(0.34735809184) = 0.36203744102
    0x0000005D9299C77ALL, // tan(0.35043205725) = 0.36551819916
    0x0000005E773A9680LL, // tan(0.35350602266) = 0.36900678801
    0x0000005F5C6053F1LL, // tan(0.35657998808) = 0.37250330018
    0x00000060420C90A5LL, // tan(0.35965395349) = 0.37600782901
    0x000000612840E09BLL, // tan(0.36272791891) = 0.37952046855
    0x000000620EFEDB00LL, // tan(0.36580188432) = 0.38304131362
    0x00000062F6481A43LL, // tan(0.36887584974) = 0.38657045976
    0x00000063DE1E3C18LL, // tan(0.37194981515) = 0.39010800330
    0x00000064C682E18DLL, // tan(0.37502378057) = 0.39365404135
    0x00000065AF77AF12LL, // tan(0.37809774598) = 0.39720867180
    0x0000006698FE4C86LL, // tan(0.38117171139) = 0.40077199333
    0x0000006783186547LL, // tan(0.38424567681) = 0.40434410546
    0x000000686DC7A83ELL, // tan(0.38731964222) = 0.40792510850
    0x00000069590DC7EBLL, // tan(0.39039360764) = 0.41151510363
    0x0000006A44EC7A74LL, // tan(0.39346757305) = 0.41511419286
    0x0000006B316579B3LL, // tan(0.39654153847) = 0.41872247907
    0x0000006C1E7A8345LL, // tan(0.39961550388) = 0.42234006600
    0x0000006D0C2D5897LL, // tan(0.40268946930) = 0.42596705830
    0x0000006DFA7FBEF4LL, // tan(0.40576343471) = 0.42960356152
    0x0000006EE9737F95LL, // tan(0.40883740012) = 0.43324968209
    0x0000006FD90A67B1LL, // tan(0.41191136554) = 0.43690552742
    0x00000070C946488ALL, // tan(0.41498533095) = 0.44057120582
    0x00000071BA28F77CLL, // tan(0.41805929637) = 0.44424682657
    0x00000072ABB44E10LL, // tan(0.42113326178) = 0.44793249994
    0x000000739DEA2A09LL, // tan(0.42420722720) = 0.45162833716
    0x0000007490CC6D76LL, // tan(0.42728119261) = 0.45533445046
    0x00000075845CFEC0LL, // tan(0.43035515803) = 0.45905095310
    0x00000076789DC8BCLL, // tan(0.43342912344) = 0.46277795935
    0x000000776D90BABFLL, // tan(0.43650308885) = 0.46651558456
    0x000000786337C8A8LL, // tan(0.43957705427) = 0.47026394509
    0x000000795994EAF9LL, // tan(0.44265101968) = 0.47402315842
    0x0000007A50AA1EE3LL, // tan(0.44572498510) = 0.47779334311
    0x0000007B4879665CLL, // tan(0.44879895051) = 0.48157461881
    0x0000007C4104C82ELL, // tan(0.45187291593) = 0.48536710632
    0x0000007D3A4E500DLL, // tan(0.45494688134) = 0.48917092757
    0x0000007E34580EA6LL, // tan(0.45802084676) = 0.49298620565
    0x0000007F2F2419B4LL, // tan(0.46109481217) = 0.49681306484
    0x000000802AB48C17LL, // tan(0.46416877759) = 0.50065163059
    0x00000081270B85DFLL, // tan(0.46724274300) = 0.50450202959
    0x00000082242B2C6ALL, // tan(0.47031670841) = 0.50836438975
    0x000000832215AA72LL, // tan(0.47339067383) = 0.51223884021
    0x0000008420CD3022LL, // tan(0.47646463924) = 0.51612551141
    0x000000852053F32ELL, // tan(0.47953860466) = 0.52002453506
    0x0000008620AC2EE9LL, // tan(0.48261257007) = 0.52393604417
    0x0000008721D82454LL, // tan(0.48568653549) = 0.52786017310
    0x0000008823DA1A3ELL, // tan(0.48876050090) = 0.53179705754
    0x0000008926B45D51LL, // tan(0.49183446632) = 0.53574683455
    0x0000008A2A694030LL, // tan(0.49490843173) = 0.53970964257
    0x0000008B2EFB1B8BLL, // tan(0.49798239714) = 0.54368562148
    0x0000008C346C4E36LL, // tan(0.50105636256) = 0.54767491254
    0x0000008D3ABF3D43LL, // tan(0.50413032797) = 0.55167765852
    0x0000008E41F65419LL, // tan(0.50720429339) = 0.55569400361
    0x0000008F4A14048FLL, // tan(0.51027825880) = 0.55972409355
    0x00000090531AC701LL, // tan(0.51335222422) = 0.56376807555
    0x000000915D0D1A6ELL, // tan(0.51642618963) = 0.56782609840
    0x0000009267ED8490LL, // tan(0.51950015505) = 0.57189831244
    0x0000009373BE91F8LL, // tan(0.52257412046) = 0.57598486961
    0x000000948082D626LL, // tan(0.52564808587) = 0.58008592346
    0x000000958E3CEBA9LL, // tan(0.52872205129) = 0.58420162920
    0x000000969CEF7438LL, // tan(0.53179601670) = 0.58833214366
    0x00000097AC9D18CCLL, // tan(0.53486998212) = 0.59247762542
    0x00000098BD4889C6LL, // tan(0.53794394753) = 0.59663823475
    0x00000099CEF47F00LL, // tan(0.54101791295) = 0.60081413365
    0x0000009AE1A3B7F5LL, // tan(0.54409187836) = 0.60500548593
    0x0000009BF558FBDDLL, // tan(0.54716584378) = 0.60921245717
    0x0000009D0A1719C7LL, // tan(0.55023980919) = 0.61343521480
    0x0000009E1FE0E8C2LL, // tan(0.55331377460) = 0.61767392809
    0x0000009F36B947F2LL, // tan(0.55638774002) = 0.62192876822
    0x000000A04EA31EBBLL, // tan(0.55946170543) = 0.62619990826
    0x000000A167A15CDDLL, // tan(0.56253567085) = 0.63048752324
    0x000000A281B6FA95LL, // tan(0.56560963626) = 0.63479179018
    0x000000A39CE6F8C3LL, // tan(0.56868360168) = 0.63911288808
    0x000000A4B934610CLL, // tan(0.57175756709) = 0.64345099801
    0x000000A5D6A245FBLL, // tan(0.57483153251) = 0.64780630311
    0x000000A6F533C32BLL, // tan(0.57790549792) = 0.65217898860
    0x000000A814EBFD68LL, // tan(0.58097946334) = 0.65656924187
    0x000000A935CE22D4LL, // tan(0.58405342875) = 0.66097725249
    0x000000AA57DD6B11LL, // tan(0.58712739416) = 0.66540321220
    0x000000AB7B1D1768LL, // tan(0.59020135958) = 0.66984731504
    0x000000AC9F9072ECLL, // tan(0.59327532499) = 0.67430975729
    0x000000ADC53AD2AALL, // tan(0.59634929041) = 0.67879073756
    0x000000AEEC1F95CDLL, // tan(0.59942325582) = 0.68329045684
    0x000000B0144225CALL, // tan(0.60249722124) = 0.68780911849
    0x000000B13DA5F68CLL, // tan(0.60557118665) = 0.69234692830
    0x000000B2684E869ELL, // tan(0.60864515207) = 0.69690409457
    0x000000B3943F5F59LL, // tan(0.61171911748) = 0.70148082807
    0x000000B4C17C1512LL, // tan(0.61479308289) = 0.70607734217
    0x000000B5F0084748LL, // tan(0.61786704831) = 0.71069385281
    0x000000B71FE7A0D1LL, // tan(0.62094101372) = 0.71533057858
    0x000000B8511DD80FLL, // tan(0.62401497914) = 0.71998774075
    0x000000B983AEAF1CLL, // tan(0.62708894455) = 0.72466556335
    0x000000BAB79DF400LL, // tan(0.63016290997) = 0.72936427314
    0x000000BBECEF80E4LL, // tan(0.63323687538) = 0.73408409974
    0x000000BD23A73C41LL, // tan(0.63631084080) = 0.73882527562
    0x000000BE5BC9191ELL, // tan(0.63938480621) = 0.74358803619
    0x000000BF9559173CLL, // tan(0.64245877162) = 0.74837261979
    0x000000C0D05B4356LL, // tan(0.64553273704) = 0.75317926783
    0x000000C20CD3B754LL, // tan(0.64860670245) = 0.75800822473
    0x000000C34AC69A88LL, // tan(0.65168066787) = 0.76285973809
    0x000000C48A3821E5LL, // tan(0.65475463328) = 0.76773405864
    0x000000C5CB2C903CLL, // tan(0.65782859870) = 0.77263144037
    0x000000C70DA8367CLL, // tan(0.66090256411) = 0.77755214052
    0x000000C851AF73EDLL, // tan(0.66397652953) = 0.78249641972
    0x000000C99746B66FLL, // tan(0.66705049494) = 0.78746454195
    0x000000CADE727ABDLL, // tan(0.67012446035) = 0.79245677468
    0x000000CC27374CAELL, // tan(0.67319842577) = 0.79747338888
    0x000000CD7199C779LL, // tan(0.67627239118) = 0.80251465912
    0x000000CEBD9E95F9LL, // tan(0.67934635660) = 0.80758086359
    0x000000D00B4A72F4LL, // tan(0.68242032201) = 0.81267228419
    0x000000D15AA22963LL, // tan(0.68549428743) = 0.81778920660
    0x000000D2ABAA94B9LL, // tan(0.68856825284) = 0.82293192035
    0x000000D3FE68A130LL, // tan(0.69164221826) = 0.82810071883
    0x000000D552E14C17LL, // tan(0.69471618367) = 0.83329589946
    0x000000D6A919A419LL, // tan(0.69779014909) = 0.83851776368
    0x000000D80116C996LL, // tan(0.70086411450) = 0.84376661703
    0x000000D95ADDEEEBLL, // tan(0.70393807991) = 0.84904276927
    0x000000DAB67458CELL, // tan(0.70701204533) = 0.85434653442
    0x000000DC13DF5E99LL, // tan(0.71008601074) = 0.85967823085
    0x000000DD73246AA9LL, // tan(0.71315997616) = 0.86503818134
    0x000000DED448FAB2LL, // tan(0.71623394157) = 0.87042671319
    0x000000E03752A019LL, // tan(0.71930790699) = 0.87584415826
    0x000000E19C470055LL, // tan(0.72238187240) = 0.88129085310
    0x000000E3032BD547LL, // tan(0.72545583782) = 0.88676713902
    0x000000E46C06ED9DLL, // tan(0.72852980323) = 0.89227336217
    0x000000E5D6DE2D35LL, // tan(0.73160376864) = 0.89780987362
    0x000000E743B78D83LL, // tan(0.73467773406) = 0.90337702947
    0x000000E8B2991DF3LL, // tan(0.73775169947) = 0.90897519094
    0x000000EA23890458LL, // tan(0.74082566489) = 0.91460472447
    0x000000EB968D7D52LL, // tan(0.74389963030) = 0.92026600179
    0x000000ED0BACDCC0LL, // tan(0.74697359572) = 0.92595940008
    0x000000EE82ED8E2FLL, // tan(0.75004756113) = 0.93168530198
    0x000000EFFC561549LL, // tan(0.75312152655) = 0.93744409580
    0x000000F177ED0E53LL, // tan(0.75619549196) = 0.94323617554
    0x000000F2F5B92E9DLL, // tan(0.75926945737) = 0.94906194103
    0x000000F475C144FELL, // tan(0.76234342279) = 0.95492179808
    0x000000F5F80C3A58LL, // tan(0.76541738820) = 0.96081615853
    0x000000F77CA11210LL, // tan(0.76849135362) = 0.96674544040
    0x000000F90386EA96LL, // tan(0.77156531903) = 0.97271006801
    0x000000FA8CC4FDECLL, // tan(0.77463928445) = 0.97871047210
    0x000000FC1862A22DLL, // tan(0.77771324986) = 0.98474708995
    0x000000FDA6674A1DLL, // tan(0.78078721528) = 0.99082036552
    0x000000FF36DA85B5LL, // tan(0.78386118069) = 0.99693074955
    0x00000100C9C402BALL, // tan(0.78693514610) = 1.00307869975
    0x000001025F2B8D52LL, // tan(0.79000911152) = 1.00926468086
    0x00000103F71910A0LL, // tan(0.79308307693) = 1.01548916489
    0x0000010591949761LL, // tan(0.79615704235) = 1.02175263115
    0x000001072EA64C8ELL, // tan(0.79923100776) = 1.02805556649
    0x00000108CE567C04LL, // tan(0.80230497318) = 1.03439846542
    0x0000010A70AD932ALL, // tan(0.80537893859) = 1.04078183024
    0x0000010C15B421A2LL, // tan(0.80845290401) = 1.04720617124
    0x0000010DBD72D9FBLL, // tan(0.81152686942) = 1.05367200682
    0x0000010F67F29265LL, // tan(0.81460083483) = 1.06017986368
    0x00000111153C4570LL, // tan(0.81767480025) = 1.06673027702
    0x00000112C55912C6LL, // tan(0.82074876566) = 1.07332379063
    0x0000011478523FF7LL, // tan(0.82382273108) = 1.07996095716
    0x000001162E31393ALL, // tan(0.82689669649) = 1.08664233825
    0x00000117E6FF9241LL, // tan(0.82997066191) = 1.09336850472
    0x00000119A2C70709LL, // tan(0.83304462732) = 1.10014003679
    0x0000011B61917CB4LL, // tan(0.83611859274) = 1.10695752425
    0x0000011D23690269LL, // tan(0.83919255815) = 1.11382156667
    0x0000011EE857D231LL, // tan(0.84226652357) = 1.12073277361
    0x00000120B06851E9LL, // tan(0.84534048898) = 1.12769176483
    0x000001227BA5142CLL, // tan(0.84841445439) = 1.13469917052
    0x000001244A18D94ALL, // tan(0.85148841981) = 1.14175563149
    0x000001261BCE9043LL, // tan(0.85456238522) = 1.14886179945
    0x00000127F0D157CBLL, // tan(0.85763635064) = 1.15601833719
    0x00000129C92C7F52LL, // tan(0.86071031605) = 1.16322591885
    0x0000012BA4EB8813LL, // tan(0.86378428147) = 1.17048523018
    0x0000012D841A262ELL, // tan(0.86685824688) = 1.17779696877
    0x0000012F66C441C3LL, // tan(0.86993221230) = 1.18516184431
    0x000001314CF5F81BLL, // tan(0.87300617771) = 1.19258057887
    0x0000013336BB9CD4LL, // tan(0.87608014312) = 1.20005390719
    0x000001352421BB17LL, // tan(0.87915410854) = 1.20758257692
    0x00000137153516D5LL, // tan(0.88222807395) = 1.21516734893
    0x000001390A02AE12LL, // tan(0.88530203937) = 1.22280899763
    0x0000013B0297BA2FLL, // tan(0.88837600478) = 1.23050831123
    0x0000013CFF01B147LL, // tan(0.89144997020) = 1.23826609209
    0x0000013EFF4E478ELL, // tan(0.89452393561) = 1.24608315703
    0x00000141038B70BELL, // tan(0.89759790103) = 1.25396033766
    0x000001430BC7618CLL, // tan(0.90067186644) = 1.26189848072
    0x0000014518109129LL, // tan(0.90374583185) = 1.26989844841
    0x000001472875BACDLL, // tan(0.90681979727) = 1.27796111880
    0x000001493D05DF4CLL, // tan(0.90989376268) = 1.28608738615
    0x0000014B55D046B5LL, // tan(0.91296772810) = 1.29427816130
    0x0000014D72E48202LL, // tan(0.91604169351) = 1.30253437208
    0x0000014F94526CD0LL, // tan(0.91911565893) = 1.31085696370
    0x00000151BA2A2F23LL, // tan(0.92218962434) = 1.31924689914
    0x00000153E47C3F3CLL, // tan(0.92526358976) = 1.32770515961
    0x0000015613596372LL, // tan(0.92833755517) = 1.33623274496
    0x0000015846D2B429LL, // tan(0.93141152058) = 1.34483067416
    0x0000015A7EF99DC6LL, // tan(0.93448548600) = 1.35349998571
    0x0000015CBBDFE2BCLL, // tan(0.93755945141) = 1.36224173818
    0x0000015EFD979DA9LL, // tan(0.94063341683) = 1.37105701064
    0x000001614433437CLL, // tan(0.94370738224) = 1.37994690321
    0x000001638FC5A5B0LL, // tan(0.94678134766) = 1.38891253753
    0x00000165E061F499LL, // tan(0.94985531307) = 1.39795505735
    0x00000168361BC1BFLL, // tan(0.95292927849) = 1.40707562905
    0x0000016A9107024ELL, // tan(0.95600324390) = 1.41627544218
    0x0000016CF1381196LL, // tan(0.95907720932) = 1.42555571012
    0x0000016F56C3B39FLL, // tan(0.96215117473) = 1.43491767059
    0x00000171C1BF17D7LL, // tan(0.96522514014) = 1.44436258633
    0x00000174323FDBCCLL, // tan(0.96829910556) = 1.45389174572
    0x00000176A85C0DFELL, // tan(0.97137307097) = 1.46350646345
    0x00000179242A30CELL, // tan(0.97444703639) = 1.47320808117
    0x0000017BA5C13D7CLL, // tan(0.97752100180) = 1.48299796821
    0x0000017E2D38A73ELL, // tan(0.98059496722) = 1.49287752231
    0x00000180BAA85E78LL, // tan(0.98366893263) = 1.50284817034
    0x000001834E28D403LL, // tan(0.98674289805) = 1.51291136910
    0x00000185E7D2FC93LL, // tan(0.98981686346) = 1.52306860606
    0x0000018887C05440LL, // tan(0.99289082887) = 1.53332140023
    0x0000018B2E0AE21CLL, // tan(0.99596479429) = 1.54367130299
    0x0000018DDACD3BF8LL, // tan(0.99903875970) = 1.55411989893
    0x000001908E228A3DLL, // tan(1.00211272512) = 1.56466880679
    0x0000019348268BE7LL, // tan(1.00518669053) = 1.57531968036
    0x0000019608F59AA5LL, // tan(1.00826065595) = 1.58607420946
    0x00000198D0ACAF19LL, // tan(1.01133462136) = 1.59693412089
    0x0000019B9F69653FLL, // tan(1.01440858678) = 1.60790117952
    0x0000019E754A00F0LL, // tan(1.01748255219) = 1.61897718928
    0x000001A1526D729DLL, // tan(1.02055651760) = 1.63016399430
    0x000001A436F35C21LL, // tan(1.02363048302) = 1.64146347999
    0x000001A722FC15C7LL, // tan(1.02670444843) = 1.65287757427
    0x000001AA16A8B37CLL, // tan(1.02977841385) = 1.66440824873
    0x000001AD121B0A27LL, // tan(1.03285237926) = 1.67605751989
    0x000001B01575B539LL, // tan(1.03592634468) = 1.68782745051
    0x000001B320DC1C6BLL, // tan(1.03900031009) = 1.69972015089
    0x000001B6347279ABLL, // tan(1.04207427551) = 1.71173778029
    0x000001B9505DDF47LL, // tan(1.04514824092) = 1.72388254834
    0x000001BC74C43E45LL, // tan(1.04822220633) = 1.73615671654
    0x000001BFA1CC6D00LL, // tan(1.05129617175) = 1.74856259977
    0x000001C2D79E2DFALL, // tan(1.05437013716) = 1.76110256789
    0x000001C6166236ECLL, // tan(1.05744410258) = 1.77377904740
    0x000001C95E42381FLL, // tan(1.06051806799) = 1.78659452315
    0x000001CCAF68E3FELL, // tan(1.06359203341) = 1.79955154005
    0x000001D00A01F6FELL, // tan(1.06666599882) = 1.81265270500
    0x000001D36E3A3FBDLL, // tan(1.06973996424) = 1.82590068871
    0x000001D6DC3FA782LL, // tan(1.07281392965) = 1.83929822769
    0x000001DA54413B00LL, // tan(1.07588789506) = 1.85284812632
    0x000001DDD66F3374LL, // tan(1.07896186048) = 1.86655325896
    0x000001E162FB0017LL, // tan(1.08203582589) = 1.88041657212
    0x000001E4FA174FEFLL, // tan(1.08510979131) = 1.89444108678
    0x000001E89BF81C01LL, // tan(1.08818375672) = 1.90862990078
    0x000001EC48D2B1E1LL, // tan(1.09125772214) = 1.92298619120
    0x000001F000DDBEB2LL, // tan(1.09433168755) = 1.93751321703
    0x000001F3C4515A90LL, // tan(1.09740565297) = 1.95221432172
    0x000001F79367146CLL, // tan(1.10047961838) = 1.96709293603
    0x000001FB6E59FE63LL, // tan(1.10355358380) = 1.98215258084
    0x000001FF5566BA8FLL, // tan(1.10662754921) = 1.99739687018
    0x0000020348CB885ELL, // tan(1.10970151462) = 2.01282951431
    0x0000020748C85270LL, // tan(1.11277548004) = 2.02845432294
    0x0000020B559EBD07LL, // tan(1.11584944545) = 2.04427520862
    0x0000020F6F92350DLL, // tan(1.11892341087) = 2.06029619022
    0x0000021396E7FFB8LL, // tan(1.12199737628) = 2.07652139657
    0x00000217CBE74AD6LL, // tan(1.12507134170) = 2.09295507028
    0x0000021C0ED93DC0LL, // tan(1.12814530711) = 2.10960157163
    0x0000022060090B0ALL, // tan(1.13121927253) = 2.12646538276
    0x00000224BFC402F2LL, // tan(1.13429323794) = 2.14355111191
    0x000002292E59A694LL, // tan(1.13736720335) = 2.16086349790
    0x0000022DAC1BBBF2LL, // tan(1.14044116877) = 2.17840741480
    0x00000232395E62DALL, // tan(1.14351513418) = 2.19618787683
    0x00000236D6782AB5LL, // tan(1.14658909960) = 2.21421004336
    0x0000023B83C2294ALL, // tan(1.14966306501) = 2.23247922428
    0x0000024041981282LL, // tan(1.15273703043) = 2.25100088551
    0x000002451058513BLL, // tan(1.15581099584) = 2.26978065475
    0x00000249F0642133LL, // tan(1.15888496126) = 2.28882432757
    0x0000024EE21FAA29LL, // tan(1.16195892667) = 2.30813787369
    0x00000253E5F21C2ELL, // tan(1.16503289208) = 2.32772744358
    0x00000258FC45CD48LL, // tan(1.16810685750) = 2.34759937536
    0x0000025E25885872LL, // tan(1.17118082291) = 2.36776020202
    0x00000263622ABE0FLL, // tan(1.17425478833) = 2.38821665898
    0x00000268B2A185DFLL, // tan(1.17732875374) = 2.40897569197
    0x0000026E1764E28FLL, // tan(1.18040271916) = 2.43004446536
    0x0000027390F0D701LL, // tan(1.18347668457) = 2.45143037080
    0x000002791FC55D51LL, // tan(1.18655064999) = 2.47314103630
    0x0000027EC4668FCCLL, // tan(1.18962461540) = 2.49518433581
    0x000002847F5CD3DDLL, // tan(1.19269858081) = 2.51756839917
    0x0000028A5135071BLL, // tan(1.19577254623) = 2.54030162261
    0x000002903A80AE8DLL, // tan(1.19884651164) = 2.56339267980
    0x000002963BD62856LL, // tan(1.20192047706) = 2.58685053334
    0x0000029C55D0DFD3LL, // tan(1.20499444247) = 2.61068444695
    0x000002A28911846ELL, // tan(1.20806840789) = 2.63490399822
    0x000002A8D63E433BLL, // tan(1.21114237330) = 2.65951909200
    0x000002AF3E030388LL, // tan(1.21421633872) = 2.68453997456
    0x000002B5C111A6A7LL, // tan(1.21729030413) = 2.70997724837
    0x000002BC60224B01LL, // tan(1.22036426955) = 2.73584188777
    0x000002C31BF392C7LL, // tan(1.22343823496) = 2.76214525541
    0x000002C9F54AEE65LL, // tan(1.22651220037) = 2.78889911957
    0x000002D0ECF4EAFDLL, // tan(1.22958616579) = 2.81611567247
    0x000002D803C5852BLL, // tan(1.23266013120) = 2.84380754949
    0x000002DF3A988053LL, // tan(1.23573409662) = 2.87198784955
    0x000002E69251C2D2LL, // tan(1.23880806203) = 2.90067015654
    0x000002EE0BDDB74ELL, // tan(1.24188202745) = 2.92986856199
    0x000002F5A831B393LL, // tan(1.24495599286) = 2.95959768900
    0x000002FD684C6548LL, // tan(1.24802995828) = 2.98987271760
    0x000003054D3644F4LL, // tan(1.25110392369) = 3.02070941146
    0x0000030D58020FA9LL, // tan(1.25417788910) = 3.05212414629
    0x0000031589CD47E3LL, // tan(1.25725185452) = 3.08413393979
    0x0000031DE3C0BE07LL, // tan(1.26032581993) = 3.11675648345
    0x0000032667112117LL, // tan(1.26339978535) = 3.15001017626
    0x0000032F14FF982BLL, // tan(1.26647375076) = 3.18391416040
    0x00000337EEDA654BLL, // tan(1.26954771618) = 3.21848835919
    0x00000340F5FD925FLL, // tan(1.27262168159) = 3.25375351738
    0x0000034A2BD3A8F4LL, // tan(1.27569564701) = 3.28973124385
    0x0000035391D6758CLL, // tan(1.27876961242) = 3.32644405718
    0x0000035D298FD777LL, // tan(1.28184357783) = 3.36391543398
    0x00000366F49A9E0CLL, // tan(1.28491754325) = 3.40216986045
    0x00000370F4A37450LL, // tan(1.28799150866) = 3.44123288717
    0x0000037B2B69DC26LL, // tan(1.29106547408) = 3.48113118768
    0x000003859AC13A42LL, // tan(1.29413943949) = 3.52189262078
    0x000003904491F42ALL, // tan(1.29721340491) = 3.56354629718
    0x0000039B2ADAA1B3LL, // tan(1.30028737032) = 3.60612265060
    0x000003A64FB15397LL, // tan(1.30336133574) = 3.64965351382
    0x000003B1B544F0CFLL, // tan(1.30643530115) = 3.69417220000
    0x000003BD5DDEAC98LL, // tan(1.30950926656) = 3.73971358980
    0x000003C94BE3972DLL, // tan(1.31258323198) = 3.78631422463
    0x000003D581D64B7ALL, // tan(1.31565719739) = 3.83401240676
    0x000003E20258BC42LL, // tan(1.31873116281) = 3.88284830662
    0x000003EED02E236DLL, // tan(1.32180512822) = 3.93286407819
    0x000003FBEE3D1674LL, // tan(1.32487909364) = 3.98410398291
    0x000004095F91C34FLL, // tan(1.32795305905) = 4.03661452311
    0x0000041727605960LL, // tan(1.33102702447) = 4.09044458563
    0x000004254907A27ELL, // tan(1.33410098988) = 4.14564559667
    0x00000433C813D07FLL, // tan(1.33717495530) = 4.20227168885
    0x00000442A8418424LL, // tan(1.34024892071) = 4.26037988163
    0x00000451ED8112E1LL, // tan(1.34332288612) = 4.32003027640
    0x000004619BFA1179LL, // tan(1.34639685154) = 4.38128626753
    0x00000471B80F2A2FLL, // tan(1.34947081695) = 4.44421477108
    0x00000482466245F0LL, // tan(1.35254478237) = 4.50888647277
    0x000004934BD910CFLL, // tan(1.35561874778) = 4.57537609730
    0x000004A4CDA1E311LL, // tan(1.35869271320) = 4.64376270097
    0x000004B6D1391921LL, // tan(1.36176667861) = 4.71412999023
    0x000004C95C6EE604LL, // tan(1.36484064403) = 4.78656666866
    0x000004DC756DAD52LL, // tan(1.36791460944) = 4.86116681558
    0x000004F022C0F33CLL, // tan(1.37098857485) = 4.93803029955
    0x000005046B5CF320LL, // tan(1.37406254027) = 5.01726323066
    0x0000051956A6EF10LL, // tan(1.37713650568) = 5.09897845589
    0x0000052EEC7E4D4ALL, // tan(1.38021047110) = 5.18329610240
    0x0000054535469B29LL, // tan(1.38328443651) = 5.27034417427
    0x0000055C39F29071LL, // tan(1.38635840193) = 5.36025920893
    0x000005740410313CLL, // tan(1.38943236734) = 5.45318700029
    0x0000058C9DD6314ALL, // tan(1.39250633276) = 5.54928339675
    0x000005A61232C004LL, // tan(1.39558029817) = 5.64871518314
    0x000005C06CDBEA67LL, // tan(1.39865426358) = 5.75166105721
    0x000005DBBA61C66DLL, // tan(1.40172822900) = 5.85831271262
    0x000005F80842A34CLL, // tan(1.40480219441) = 5.96887604224
    0x00000615650182C7LL, // tan(1.40787615983) = 6.08357247775
    0x00000633E03F2A5DLL, // tan(1.41095012524) = 6.20264048371
    0x000006538AD62769LL, // tan(1.41402409066) = 6.32633722746
    0x0000067476FA2FECLL, // tan(1.41709805607) = 6.45494044943
    0x00000696B85B5AF2LL, // tan(1.42017202149) = 6.58875056239
    0x000006BA644DC004LL, // tan(1.42324598690) = 6.72809301317
    0x000006DF91F62580LL, // tan(1.42631995231) = 6.87332094589
    0x000007065A7C82ECLL, // tan(1.42939391773) = 7.02481821247
    0x0000072ED9453F4ELL, // tan(1.43246788314) = 7.18300278469
    0x000007592C323DD9LL, // tan(1.43554184856) = 7.34833063135
    0x0000078573ECFE37LL, // tan(1.43861581397) = 7.52130013663
    0x000007B3D43B53C3LL, // tan(1.44168977939) = 7.70245714946
    0x000007E474608271LL, // tan(1.44476374480) = 7.89240077195
    0x000008177F8CECE9LL, // tan(1.44783771022) = 8.09179001602
    0x0000084D255EF112LL, // tan(1.45091167563) = 8.30135148416
    0x000008859A781D55LL, // tan(1.45398564104) = 8.52188826290
    0x000008C1192A980DLL, // tan(1.45705960646) = 8.75429025852
    0x000008FFE2436D84LL, // tan(1.46013357187) = 8.99954625534
    0x000009423DF78C38LL, // tan(1.46320753729) = 9.25875804113
    0x000009887CFA9352LL, // tan(1.46628150270) = 9.53315702531
    0x000009D2F9C8523DLL, // tan(1.46935546812) = 9.82412387855
    0x00000A221A2C1037LL, // tan(1.47242943353) = 10.13321185490
    0x00000A7651138F1FLL, // tan(1.47550339895) = 10.46217462773
    0x00000AD020BF7539LL, // tan(1.47857736436) = 10.81299969303
    0x00000B301D67A989LL, // tan(1.48165132978) = 11.18794868363
    0x00000B96F0709F62LL, // tan(1.48472529519) = 11.58960632221
    0x00000C055C57248CLL, // tan(1.48779926060) = 12.02094025271
    0x00000C7C4183D517LL, // tan(1.49087322602) = 12.48537467911
    0x00000CFCA4471175LL, // tan(1.49394719143) = 12.98688167740
    0x00000D87B453F205LL, // tan(1.49702115685) = 13.53009533557
    0x00000E1ED62EC824LL, // tan(1.50009512226) = 14.12045566927
    0x00000EC3AF2E1F76LL, // tan(1.50316908768) = 14.76439178722
    0x00000F7834E9BF99LL, // tan(1.50624305309) = 15.46955738952
    0x0000103EC14AFB28LL, // tan(1.50931701851) = 16.24513691551
    0x0000111A2CF2FCB3LL, // tan(1.51239098392) = 17.10224836988
    0x0000120DF26DD81ALL, // tan(1.51546494933) = 18.05448042417
    0x0000131E5DD1FC53LL, // tan(1.51853891475) = 19.11861908350
    0x00001450CE3B6FE5LL, // tan(1.52161288016) = 20.31564685327
    0x000015AC117858C4LL, // tan(1.52468684558) = 21.67214157264
    0x00001738E6FF753DLL, // tan(1.52776081099) = 23.22227474797
    0x00001902BF585698LL, // tan(1.53083477641) = 25.01073219408
    0x00001B18DB37B8F4LL, // tan(1.53390874182) = 27.09709499612
    0x00001D900736F3E6LL, // tan(1.53698270724) = 29.56261008696
    0x0000208561C6482ALL, // tan(1.54005667265) = 32.52102317106
    0x00002422FA6B6130LL, // tan(1.54313063806) = 36.13663359759
    0x000028A7E86EB7CDLL, // tan(1.54620460348) = 40.65589038837
    0x00002E775066B736LL, // tan(1.54927856889) = 46.46607057546
    0x000036366F4E0703LL, // tan(1.55235253431) = 54.21263587638
    0x0000410EB2E7C78ELL, // tan(1.55542649972) = 65.05741737959
    0x00005152F6BA28E4LL, // tan(1.55850046514) = 81.32407725809
    0x00006C6F3AFE2FA1LL, // tan(1.56157443055) = 108.43449391044
    0x0000A2A7805EC851LL, // tan(1.56464839597) = 162.65430252448
    0x0001454FCA324F25LL, // tan(1.56772236138) = 325.31167902405
    0x7FFFFFFFFFFFFFFFLL  // tan(1.57079632679) = 8388608.00000000000
};

// Lookup tan(x) with linear interpolation between table entries
// Input x is in fixed-point format with specified fraction bits representing angle in radians
// Output is in Q23.40 fixed-point format representing tan(x)
inline constexpr auto LookupTan(int64_t x, int input_fraction_bits) noexcept -> int64_t {
    // Constants
    constexpr int64_t kPi = 0x000003243F6A8885LL;  // pi = 3.141592653589793
    constexpr int64_t kPiOver2 = 0x000001921FB54442LL;  // pi/2 = 1.5707963267948966
    constexpr int64_t kLutInterval = 0x000145500D592E39LL;  // LUT conversion factor
    constexpr int64_t kMaxValue = INT64_MAX;  // Maximum representable value
    constexpr int kOutputFractionBits = 40;  // Output format: Q23.40

    // Convert input to Q23.40 format if needed
    if (input_fraction_bits != kOutputFractionBits) {
        if (input_fraction_bits < kOutputFractionBits) {
            x <<= (kOutputFractionBits - input_fraction_bits);
        } else {
            x >>= (input_fraction_bits - kOutputFractionBits);
        }
    }

    // 1. Normalize angle to [-pi, pi]
    x = x % kPi;

    // 2. Handle negative angles
    bool flip = false;
    if (x < 0) {
        x = -x;
        flip = true;
    }

    // 3. Handle angles > pi/2 by using tan(pi-x) = -tan(x)
    if (x > kPiOver2) {
        x = kPi - x;
        flip = !flip;
    }

    // 4. Calculate lookup table index and fractional part
    int64_t raw_index = Primitives::Fixed64Mul(x, kLutInterval, kOutputFractionBits);
    size_t index = static_cast<size_t>(raw_index >> kOutputFractionBits);
    int64_t fraction = raw_index & ((1LL << kOutputFractionBits) - 1);

    // 5. Handle index at or beyond the end of the table
    if (index >= kTanLut.size() - 1) {
        return flip ? -kMaxValue : kMaxValue;
    }

    // 6. Linear interpolation
    int64_t a = kTanLut[index];
    int64_t b = kTanLut[index + 1];
    int64_t delta = Primitives::Fixed64Mul(fraction, b - a, kOutputFractionBits);
    int64_t interpolated_value = a + delta;

    // 7. Apply sign flip if necessary
    int64_t result = flip ? -interpolated_value : interpolated_value;

    // 8. Convert result back to original input format if needed
    if (input_fraction_bits != kOutputFractionBits) {
        if (input_fraction_bits < kOutputFractionBits) {
            result >>= (kOutputFractionBits - input_fraction_bits);
        } else {
            result <<= (input_fraction_bits - kOutputFractionBits);
        }
    }

    return result;
}

}  // namespace math::fp::detail