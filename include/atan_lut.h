#pragma once

#include <stdint.h>
#include <array>
#include "primitives.h"

// Atan lookup table with 512 entries
// Covers the range [0,1] with values in Q31.32 format
// Generated with mpmath library at 100 digits precision

namespace math::fp::detail {
// Table maps x in [0,1] to atan(x)
// Values stored in Q31.32 fixed-point format
inline constexpr std::array<int64_t, 512> kAtanLut = {
    0x0000000000000000LL,  // atan(0.000000000) = 0.000000000000000000
    0x0000000000804015LL,  // atan(0.001956947) = 0.001956944664296545
    0x0000000001007FEALL,  // atan(0.003913894) = 0.003913874339950434
    0x000000000180BF3ELL,  // atan(0.005870841) = 0.005870774039007806
    0x000000000200FDD1LL,  // atan(0.007827789) = 0.007827628774892313
    0x0000000002813B63LL,  // atan(0.009784736) = 0.009784423563093675
    0x00000000030177B3LL,  // atan(0.011741683) = 0.011741143421855999
    0x000000000381B280LL,  // atan(0.013698630) = 0.013697773372865788
    0x000000000401EB8BLL,  // atan(0.015655577) = 0.015654298441939551
    0x0000000004822294LL,  // atan(0.017612524) = 0.017610703659710927
    0x0000000005025759LL,  // atan(0.019569472) = 0.019566974062317281
    0x000000000582899BLL,  // atan(0.021526419) = 0.021523094692085642
    0x000000000602B91ALL,  // atan(0.023483366) = 0.023479050598217945
    0x000000000682E595LL,  // atan(0.025440313) = 0.025434826837475496
    0x0000000007030ECCLL,  // atan(0.027397260) = 0.027390408474862536
    0x000000000783347FLL,  // atan(0.029354207) = 0.029345780584308891
    0x000000000803566FLL,  // atan(0.031311155) = 0.031300928249351601
    0x000000000883745ALL,  // atan(0.033268102) = 0.033255836563815401
    0x0000000009038E01LL,  // atan(0.035225049) = 0.035210490632492118
    0x000000000983A325LL,  // atan(0.037181996) = 0.037164875571818690
    0x000000000A03B384LL,  // atan(0.039138943) = 0.039118976510553974
    0x000000000A83BEE0LL,  // atan(0.041095890) = 0.041072778590454072
    0x000000000B03C4F9LL,  // atan(0.043052838) = 0.043026266966946169
    0x000000000B83C58FLL,  // atan(0.045009785) = 0.044979426809800889
    0x000000000C03C062LL,  // atan(0.046966732) = 0.046932243303802891
    0x000000000C83B532LL,  // atan(0.048923679) = 0.048884701649419889
    0x000000000D03A3C1LL,  // atan(0.050880626) = 0.050836787063469779
    0x000000000D838BCFLL,  // atan(0.052837573) = 0.052788484779785962
    0x000000000E036D1DLL,  // atan(0.054794521) = 0.054739780049880706
    0x000000000E83476ALL,  // atan(0.056751468) = 0.056690658143606534
    0x000000000F031A79LL,  // atan(0.058708415) = 0.058641104349815475
    0x000000000F82E60ALL,  // atan(0.060665362) = 0.060591103977016225
    0x000000001002A9DDLL,  // atan(0.062622309) = 0.062540642354029022
    0x00000000108265B5LL,  // atan(0.064579256) = 0.064489704830638275
    0x0000000011021951LL,  // atan(0.066536204) = 0.066438276778242766
    0x000000001181C475LL,  // atan(0.068493151) = 0.068386343590503454
    0x00000000120166E0LL,  // atan(0.070450098) = 0.070333890683988806
    0x0000000012810054LL,  // atan(0.072407045) = 0.072280903498817384
    0x0000000013009093LL,  // atan(0.074363992) = 0.074227367499297980
    0x000000001380175FLL,  // atan(0.076320939) = 0.076173268174566947
    0x0000000013FF9479LL,  // atan(0.078277886) = 0.078118591039222682
    0x00000000147F07A4LL,  // atan(0.080234834) = 0.080063321633957338
    0x0000000014FE70A0LL,  // atan(0.082191781) = 0.082007445526185607
    0x00000000157DCF31LL,  // atan(0.084148728) = 0.083950948310670459
    0x0000000015FD2318LL,  // atan(0.086105675) = 0.085893815610145863
    0x00000000167C6C19LL,  // atan(0.088062622) = 0.087836033075936418
    0x0000000016FBA9F5LL,  // atan(0.090019569) = 0.089777586388573707
    0x00000000177ADC6FLL,  // atan(0.091976517) = 0.091718461258409503
    0x0000000017FA034ALL,  // atan(0.093933464) = 0.093658643426225624
    0x0000000018791E49LL,  // atan(0.095890411) = 0.095598118663840381
    0x0000000018F82D2ELL,  // atan(0.097847358) = 0.097536872774711611
    0x0000000019772FBELL,  // atan(0.099804305) = 0.099474891594536263
    0x0000000019F625BALL,  // atan(0.101761252) = 0.101412160991846356
    0x000000001A750EE8LL,  // atan(0.103718200) = 0.103348666868601322
    0x000000001AF3EB09LL,  // atan(0.105675147) = 0.105284395160776728
    0x000000001B72B9E3LL,  // atan(0.107632094) = 0.107219331838949244
    0x000000001BF17B39LL,  // atan(0.109589041) = 0.109153462908877730
    0x000000001C702ECFLL,  // atan(0.111545988) = 0.111086774412080647
    0x000000001CEED468LL,  // atan(0.113502935) = 0.113019252426409367
    0x000000001D6D6BCBLL,  // atan(0.115459883) = 0.114950883066617687
    0x000000001DEBF4BALL,  // atan(0.117416830) = 0.116881652484927254
    0x000000001E6A6EFCLL,  // atan(0.119373777) = 0.118811546871588861
    0x000000001EE8DA54LL,  // atan(0.121330724) = 0.120740552455439756
    0x000000001F673687LL,  // atan(0.123287671) = 0.122668655504456714
    0x000000001FE5835CLL,  // atan(0.125244618) = 0.124595842326304815
    0x000000002063C096LL,  // atan(0.127201566) = 0.126522099268882054
    0x0000000020E1EDFCLL,  // atan(0.129158513) = 0.128447412720859605
    0x0000000021600B54LL,  // atan(0.131115460) = 0.130371769112217623
    0x0000000021DE1863LL,  // atan(0.133072407) = 0.132295154914776780
    0x00000000225C14F0LL,  // atan(0.135029354) = 0.134217556642725139
    0x0000000022DA00C0LL,  // atan(0.136986301) = 0.136138960853140756
    0x000000002357DB9ALL,  // atan(0.138943249) = 0.138059354146509466
    0x0000000023D5A546LL,  // atan(0.140900196) = 0.139978723167238278
    0x0000000024535D88LL,  // atan(0.142857143) = 0.141897054604163936
    0x0000000024D1042ALL,  // atan(0.144814090) = 0.143814335191056991
    0x00000000254E98F1LL,  // atan(0.146771037) = 0.145730551707121014
    0x0000000025CC1BA6LL,  // atan(0.148727984) = 0.147645690977487032
    0x0000000026498C0FLL,  // atan(0.150684932) = 0.149559739873703162
    0x0000000026C6E9F5LL,  // atan(0.152641879) = 0.151472685314219535
    0x0000000027443520LL,  // atan(0.154598826) = 0.153384514264868099
    0x0000000027C16D58LL,  // atan(0.156555773) = 0.155295213739337606
    0x00000000283E9265LL,  // atan(0.158512720) = 0.157204770799643789
    0x0000000028BBA410LL,  // atan(0.160469667) = 0.159113172556594185
    0x000000002938A222LL,  // atan(0.162426614) = 0.161020406170248404
    0x0000000029B58C64LL,  // atan(0.164383562) = 0.162926458850372741
    0x000000002A32629FLL,  // atan(0.166340509) = 0.164831317856890369
    0x000000002AAF249DLL,  // atan(0.168297456) = 0.166734970500325763
    0x000000002B2BD227LL,  // atan(0.170254403) = 0.168637404142244485
    0x000000002BA86B08LL,  // atan(0.172211350) = 0.170538606195687392
    0x000000002C24EF09LL,  // atan(0.174168297) = 0.172438564125599852
    0x000000002CA15DF5LL,  // atan(0.176125245) = 0.174337265449255707
    0x000000002D1DB797LL,  // atan(0.178082192) = 0.176234697736675799
    0x000000002D99FBB9LL,  // atan(0.180039139) = 0.178130848611041392
    0x000000002E162A26LL,  // atan(0.181996086) = 0.180025705749102177
    0x000000002E9242AALL,  // atan(0.183953033) = 0.181919256881578922
    0x000000002F0E4511LL,  // atan(0.185909980) = 0.183811489793560823
    0x000000002F8A3125LL,  // atan(0.187866928) = 0.185702392324897353
    0x00000000300606B4LL,  // atan(0.189823875) = 0.187591952370584791
    0x000000003081C589LL,  // atan(0.191780822) = 0.189480157881147332
    0x0000000030FD6D71LL,  // atan(0.193737769) = 0.191366996863012617
    0x000000003178FE38LL,  // atan(0.195694716) = 0.193252457378882025
    0x0000000031F477ACLL,  // atan(0.197651663) = 0.195136527548095129
    0x00000000326FD999LL,  // atan(0.199608611) = 0.197019195546989045
    0x0000000032EB23CELL,  // atan(0.201565558) = 0.198900449609251961
    0x0000000033665617LL,  // atan(0.203522505) = 0.200780278026271269
    0x0000000033E17044LL,  // atan(0.205479452) = 0.202658669147476128
    0x00000000345C7221LL,  // atan(0.207436399) = 0.204535611380674526
    0x0000000034D75B7ELL,  // atan(0.209393346) = 0.206411093192384487
    0x0000000035522C2ALL,  // atan(0.211350294) = 0.208285103108160258
    0x0000000035CCE3F2LL,  // atan(0.213307241) = 0.210157629712912214
    0x00000000364782A7LL,  // atan(0.215264188) = 0.212028661651221723
    0x0000000036C20818LL,  // atan(0.217221135) = 0.213898187627650171
    0x00000000373C7415LL,  // atan(0.219178082) = 0.215766196407042310
    0x0000000037B6C66DLL,  // atan(0.221135029) = 0.217632676814824039
    0x000000003830FEF1LL,  // atan(0.223091977) = 0.219497617737294731
    0x0000000038AB1D72LL,  // atan(0.225048924) = 0.221361008121913644
    0x00000000392521C0LL,  // atan(0.227005871) = 0.223222836977580774
    0x00000000399F0BACLL,  // atan(0.228962818) = 0.225083093374912308
    0x000000003A18DB08LL,  // atan(0.230919765) = 0.226941766446510068
    0x000000003A928FA6LL,  // atan(0.232876712) = 0.228798845387225613
    0x000000003B0C2956LL,  // atan(0.234833659) = 0.230654319454418499
    0x000000003B85A7ECLL,  // atan(0.236790607) = 0.232508177968209023
    0x000000003BFF0B39LL,  // atan(0.238747554) = 0.234360410311725248
    0x000000003C785311LL,  // atan(0.240704501) = 0.236211005931344448
    0x000000003CF17F46LL,  // atan(0.242661448) = 0.238059954336928919
    0x000000003D6A8FABLL,  // atan(0.244618395) = 0.239907245102056049
    0x000000003DE38415LL,  // atan(0.246575342) = 0.241752867864242965
    0x000000003E5C5C56LL,  // atan(0.248532290) = 0.243596812325165335
    0x000000003ED51843LL,  // atan(0.250489237) = 0.245439068250870779
    0x000000003F4DB7B0LL,  // atan(0.252446184) = 0.247279625471986425
    0x000000003FC63A72LL,  // atan(0.254403131) = 0.249118473883921165
    0x00000000403EA05DLL,  // atan(0.256360078) = 0.250955603447062026
    0x0000000040B6E947LL,  // atan(0.258317025) = 0.252791004186965262
    0x00000000412F1506LL,  // atan(0.260273973) = 0.254624666194541494
    0x0000000041A7236ELL,  // atan(0.262230920) = 0.256456579626235692
    0x00000000421F1456LL,  // atan(0.264187867) = 0.258286734704201437
    0x000000004296E794LL,  // atan(0.266144814) = 0.260115121716469500
    0x00000000430E9D00LL,  // atan(0.268101761) = 0.261941731017111323
    0x000000004386346FLL,  // atan(0.270058708) = 0.263766553026396400
    0x0000000043FDADB8LL,  // atan(0.272015656) = 0.265589578230944756
    0x00000000447508B4LL,  // atan(0.273972603) = 0.267410797183873561
    0x0000000044EC453ALL,  // atan(0.275929550) = 0.269230200504938511
    0x0000000045636321LL,  // atan(0.277886497) = 0.271047778880669665
    0x0000000045DA6243LL,  // atan(0.279843444) = 0.272863523064501790
    0x0000000046514278LL,  // atan(0.281800391) = 0.274677423876899474
    0x0000000046C80398LL,  // atan(0.283757339) = 0.276489472205476705
    0x00000000473EA57DLL,  // atan(0.285714286) = 0.278299659005111333
    0x0000000047B52801LL,  // atan(0.287671233) = 0.280107975298053757
    0x00000000482B8AFCLL,  // atan(0.289628180) = 0.281914412174030737
    0x0000000048A1CE49LL,  // atan(0.291585127) = 0.283718960790343533
    0x000000004917F1C3LL,  // atan(0.293542074) = 0.285521612371961164
    0x00000000498DF543LL,  // atan(0.295499022) = 0.287322358211608009
    0x000000004A03D8A6LL,  // atan(0.297455969) = 0.289121189669846568
    0x000000004A799BC5LL,  // atan(0.299412916) = 0.290918098175154516
    0x000000004AEF3E7DLL,  // atan(0.301369863) = 0.292713075223997143
    0x000000004B64C0A9LL,  // atan(0.303326810) = 0.294506112380894136
    0x000000004BDA2225LL,  // atan(0.305283757) = 0.296297201278481748
    0x000000004C4F62CELL,  // atan(0.307240705) = 0.298086333617569310
    0x000000004CC48280LL,  // atan(0.309197652) = 0.299873501167191081
    0x000000004D398118LL,  // atan(0.311154599) = 0.301658695764652762
    0x000000004DAE5E74LL,  // atan(0.313111546) = 0.303441909315573244
    0x000000004E231A71LL,  // atan(0.315068493) = 0.305223133793921408
    0x000000004E97B4EDLL,  // atan(0.317025440) = 0.307002361242047328
    0x000000004F0C2DC5LL,  // atan(0.318982387) = 0.308779583770709576
    0x000000004F8084D9LL,  // atan(0.320939335) = 0.310554793559096542
    0x000000004FF4BA07LL,  // atan(0.322896282) = 0.312327982854843922
    0x000000005068CD2FLL,  // atan(0.324853229) = 0.314099143974046424
    0x0000000050DCBE2ELL,  // atan(0.326810176) = 0.315868269301265270
    0x0000000051508CE5LL,  // atan(0.328767123) = 0.317635351289530687
    0x0000000051C43934LL,  // atan(0.330724070) = 0.319400382460339916
    0x000000005237C2FCLL,  // atan(0.332681018) = 0.321163355403649931
    0x0000000052AB2A1BLL,  // atan(0.334637965) = 0.322924262777866178
    0x00000000531E6E74LL,  // atan(0.336594912) = 0.324683097309826085
    0x0000000053918FE7LL,  // atan(0.338551859) = 0.326439851794778468
    0x0000000054048E56LL,  // atan(0.340508806) = 0.328194519096357884
    0x00000000547769A2LL,  // atan(0.342465753) = 0.329947092146554766
    0x0000000054EA21ADLL,  // atan(0.344422701) = 0.331697563945681062
    0x00000000555CB659LL,  // atan(0.346379648) = 0.333445927562331157
    0x0000000055CF278ALL,  // atan(0.348336595) = 0.335192176133338404
    0x0000000056417521LL,  // atan(0.350293542) = 0.336936302863727666
    0x0000000056B39F02LL,  // atan(0.352250489) = 0.338678301026662909
    0x000000005725A511LL,  // atan(0.354207436) = 0.340418163963390863
    0x0000000057978730LL,  // atan(0.356164384) = 0.342155885083180289
    0x0000000058094544LL,  // atan(0.358121331) = 0.343891457863256977
    0x00000000587ADF32LL,  // atan(0.360078278) = 0.345624875848734470
    0x0000000058EC54DDLL,  // atan(0.362035225) = 0.347356132652540839
    0x00000000595DA62BLL,  // atan(0.363992172) = 0.349085221955341030
    0x0000000059CED301LL,  // atan(0.365949119) = 0.350812137505455368
    0x000000005A3FDB44LL,  // atan(0.367906067) = 0.352536873118773741
    0x000000005AB0BEDALL,  // atan(0.369863014) = 0.354259422678666114
    0x000000005B217DA9LL,  // atan(0.371819961) = 0.355979780135888768
    0x000000005B921798LL,  // atan(0.373776908) = 0.357697939508486606
    0x000000005C028C8CLL,  // atan(0.375733855) = 0.359413894881691898
    0x000000005C72DC6DLL,  // atan(0.377690802) = 0.361127640407818640
    0x000000005CE30722LL,  // atan(0.379647750) = 0.362839170306153591
    0x000000005D530C92LL,  // atan(0.381604697) = 0.364548478862843195
    0x000000005DC2ECA6LL,  // atan(0.383561644) = 0.366255560430776950
    0x000000005E32A744LL,  // atan(0.385518591) = 0.367960409429466950
    0x000000005EA23C56LL,  // atan(0.387475538) = 0.369663020344923876
    0x000000005F11ABC5LL,  // atan(0.389432485) = 0.371363387729529315
    0x000000005F80F578LL,  // atan(0.391389432) = 0.373061506201904536
    0x000000005FF0195ALL,  // atan(0.393346380) = 0.374757370446775651
    0x00000000605F1753LL,  // atan(0.395303327) = 0.376450975214835448
    0x0000000060CDEF4DLL,  // atan(0.397260274) = 0.378142315322601452
    0x00000000613CA133LL,  // atan(0.399217221) = 0.379831385652271147
    0x0000000061AB2CEELL,  // atan(0.401174168) = 0.381518181151573155
    0x000000006219926ALL,  // atan(0.403131115) = 0.383202696833615464
    0x000000006287D191LL,  // atan(0.405088063) = 0.384884927776730501
    0x0000000062F5EA4ELL,  // atan(0.407045010) = 0.386564869124316535
    0x000000006363DC8DLL,  // atan(0.409001957) = 0.388242516084676303
    0x0000000063D1A839LL,  // atan(0.410958904) = 0.389917863930852149
    0x00000000643F4D3FLL,  // atan(0.412915851) = 0.391590908000458315
    0x0000000064ACCB8ALL,  // atan(0.414872798) = 0.393261643695509977
    0x00000000651A2307LL,  // atan(0.416829746) = 0.394930066482249320
    0x00000000658753A3LL,  // atan(0.418786693) = 0.396596171890968408
    0x0000000065F45D4CLL,  // atan(0.420743640) = 0.398259955515829711
    0x0000000066613FEDLL,  // atan(0.422700587) = 0.399921413014682925
    0x0000000066CDFB76LL,  // atan(0.424657534) = 0.401580540108879502
    0x00000000673A8FD3LL,  // atan(0.426614481) = 0.403237332583084140
    0x0000000067A6FCF4LL,  // atan(0.428571429) = 0.404891786285083433
    0x00000000681342C6LL,  // atan(0.430528376) = 0.406543897125592024
    0x00000000687F6138LL,  // atan(0.432485323) = 0.408193661078055825
    0x0000000068EB583ALL,  // atan(0.434442270) = 0.409841074178452613
    0x00000000695727B9LL,  // atan(0.436399217) = 0.411486132525090087
    0x0000000069C2CFA7LL,  // atan(0.438356164) = 0.413128832278401414
    0x000000006A2E4FF3LL,  // atan(0.440313112) = 0.414769169660737957
    0x000000006A99A88CLL,  // atan(0.442270059) = 0.416407140956159993
    0x000000006B04D963LL,  // atan(0.444227006) = 0.418042742510224441
    0x000000006B6FE269LL,  // atan(0.446183953) = 0.419675970729770531
    0x000000006BDAC38ELL,  // atan(0.448140900) = 0.421306822082703092
    0x000000006C457CC4LL,  // atan(0.450097847) = 0.422935293097773335
    0x000000006CB00DFBLL,  // atan(0.452054795) = 0.424561380364357588
    0x000000006D1A7726LL,  // atan(0.454011742) = 0.426185080532233529
    0x000000006D84B837LL,  // atan(0.455968689) = 0.427806390311354423
    0x000000006DEED11FLL,  // atan(0.457925636) = 0.429425306471621193
    0x000000006E58C1D1LL,  // atan(0.459882583) = 0.431041825842652049
    0x000000006EC28A3FLL,  // atan(0.461839530) = 0.432655945313550783
    0x000000006F2C2A5DLL,  // atan(0.463796477) = 0.434267661832671958
    0x000000006F95A21DLL,  // atan(0.465753425) = 0.435876972407385099
    0x000000006FFEF173LL,  // atan(0.467710372) = 0.437483874103836323
    0x0000000070681853LL,  // atan(0.469667319) = 0.439088364046708424
    0x0000000070D116B0LL,  // atan(0.471624266) = 0.440690439418978508
    0x000000007139EC7FLL,  // atan(0.473581213) = 0.442290097461674581
    0x0000000071A299B4LL,  // atan(0.475538160) = 0.443887335473629685
    0x00000000720B1E44LL,  // atan(0.477495108) = 0.445482150811234601
    0x0000000072737A23LL,  // atan(0.479452055) = 0.447074540888188710
    0x0000000072DBAD48LL,  // atan(0.481409002) = 0.448664503175249196
    0x000000007343B7A6LL,  // atan(0.483365949) = 0.450252035199978640
    0x0000000073AB9933LL,  // atan(0.485322896) = 0.451837134546491048
    0x00000000741351E7LL,  // atan(0.487279843) = 0.453419798855196066
    0x00000000747AE1B6LL,  // atan(0.489236791) = 0.455000025822541954
    0x0000000074E24897LL,  // atan(0.491193738) = 0.456577813200757077
    0x0000000075498681LL,  // atan(0.493150685) = 0.458153158797589610
    0x0000000075B09B6ALL,  // atan(0.495107632) = 0.459726060476046139
    0x000000007617874ALL,  // atan(0.497064579) = 0.461296516154128700
    0x00000000767E4A18LL,  // atan(0.499021526) = 0.462864523804570771
    0x0000000076E4E3CBLL,  // atan(0.500978474) = 0.464430081454571597
    0x00000000774B545BLL,  // atan(0.502935421) = 0.465993187185529290
    0x0000000077B19BC0LL,  // atan(0.504892368) = 0.467553839132773097
    0x000000007817B9F2LL,  // atan(0.506849315) = 0.469112035485293843
    0x00000000787DAEEALL,  // atan(0.508806262) = 0.470667774485473756
    0x0000000078E37AA1LL,  // atan(0.510763209) = 0.472221054428815012
    0x0000000079491D0FLL,  // atan(0.512720157) = 0.473771873663666909
    0x0000000079AE962DLL,  // atan(0.514677104) = 0.475320230590952408
    0x000000007A13E5F5LL,  // atan(0.516634051) = 0.476866123663893249
    0x000000007A790C61LL,  // atan(0.518590998) = 0.478409551387734611
    0x000000007ADE096ALL,  // atan(0.520547945) = 0.479950512319468225
    0x000000007B42DD0ALL,  // atan(0.522504892) = 0.481489005067554932
    0x000000007BA7873BLL,  // atan(0.524461840) = 0.483025028291646286
    0x000000007C0C07F9LL,  // atan(0.526418787) = 0.484558580702305230
    0x000000007C705F3DLL,  // atan(0.528375734) = 0.486089661060726097
    0x000000007CD48D02LL,  // atan(0.530332681) = 0.487618268178453829
    0x000000007D389144LL,  // atan(0.532289628) = 0.489144400917101985
    0x000000007D9C6BFFLL,  // atan(0.534246575) = 0.490668058188070910
    0x000000007E001D2CLL,  // atan(0.536203523) = 0.492189238952264352
    0x000000007E63A4C9LL,  // atan(0.538160470) = 0.493707942219805906
    0x000000007EC702D1LL,  // atan(0.540117417) = 0.495224167049754860
    0x000000007F2A3741LL,  // atan(0.542074364) = 0.496737912549820915
    0x000000007F8D4214LL,  // atan(0.544031311) = 0.498249177876079252
    0x000000007FF02347LL,  // atan(0.545988258) = 0.499757962232684039
    0x000000008052DAD8LL,  // atan(0.547945205) = 0.501264264871582488
    0x0000000080B568C2LL,  // atan(0.549902153) = 0.502768085092227257
    0x000000008117CD04LL,  // atan(0.551859100) = 0.504269422241289678
    0x00000000817A079BLL,  // atan(0.553816047) = 0.505768275712371818
    0x0000000081DC1884LL,  // atan(0.555772994) = 0.507264644945717769
    0x00000000823DFFBDLL,  // atan(0.557729941) = 0.508758529427925876
    0x00000000829FBD44LL,  // atan(0.559686888) = 0.510249928691659527
    0x0000000083015117LL,  // atan(0.561643836) = 0.511738842315357934
    0x000000008362BB35LL,  // atan(0.563600783) = 0.513225269922946703
    0x0000000083C3FB9CLL,  // atan(0.565557730) = 0.514709211183548621
    0x000000008425124CLL,  // atan(0.567514677) = 0.516190665811193106
    0x000000008485FF42LL,  // atan(0.569471624) = 0.517669633564526777
    0x0000000084E6C27ELL,  // atan(0.571428571) = 0.519146114246522905
    0x0000000085475C00LL,  // atan(0.573385519) = 0.520620107704191315
    0x0000000085A7CBC6LL,  // atan(0.575342466) = 0.522091613828287504
    0x00000000860811D2LL,  // atan(0.577299413) = 0.523560632553022764
    0x0000000086682E22LL,  // atan(0.579256360) = 0.525027163855773193
    0x0000000086C820B6LL,  // atan(0.581213307) = 0.526491207756789148
    0x000000008727E990LL,  // atan(0.583170254) = 0.527952764318904810
    0x00000000878788AFLL,  // atan(0.585127202) = 0.529411833647247421
    0x0000000087E6FE14LL,  // atan(0.587084149) = 0.530868415888947176
    0x00000000884649C0LL,  // atan(0.589041096) = 0.532322511232846018
    0x0000000088A56BB4LL,  // atan(0.590998043) = 0.533774119909208200
    0x00000000890463F1LL,  // atan(0.592954990) = 0.535223242189429405
    0x0000000089633278LL,  // atan(0.594911937) = 0.536669878385746868
    0x0000000089C1D74BLL,  // atan(0.596868885) = 0.538114028850949500
    0x000000008A20526CLL,  // atan(0.598825832) = 0.539555693978088113
    0x000000008A7EA3DBLL,  // atan(0.600782779) = 0.540994874200186104
    0x000000008ADCCB9DLL,  // atan(0.602739726) = 0.542431569989949902
    0x000000008B3AC9B2LL,  // atan(0.604696673) = 0.543865781859479980
    0x000000008B989E1DLL,  // atan(0.606653620) = 0.545297510359982196
    0x000000008BF648E1LL,  // atan(0.608610568) = 0.546726756081479581
    0x000000008C53CA00LL,  // atan(0.610567515) = 0.548153519652523791
    0x000000008CB1217DLL,  // atan(0.612524462) = 0.549577801739907446
    0x000000008D0E4F5BLL,  // atan(0.614481409) = 0.550999603048377029
    0x000000008D6B539DLL,  // atan(0.616438356) = 0.552418924320345450
    0x000000008DC82E47LL,  // atan(0.618395303) = 0.553835766335605717
    0x000000008E24DF5DLL,  // atan(0.620352250) = 0.555250129911044499
    0x000000008E8166E1LL,  // atan(0.622309198) = 0.556662015900356577
    0x000000008EDDC4D8LL,  // atan(0.624266145) = 0.558071425193759185
    0x000000008F39F945LL,  // atan(0.626223092) = 0.559478358717707680
    0x000000008F96042DLL,  // atan(0.628180039) = 0.560882817434610659
    0x000000008FF1E595LL,  // atan(0.630136986) = 0.562284802342546852
    0x00000000904D9D7FLL,  // atan(0.632093933) = 0.563684314474980908
    0x0000000090A92BF2LL,  // atan(0.634050881) = 0.565081354900481503
    0x00000000910490F2LL,  // atan(0.636007828) = 0.566475924722438906
    0x00000000915FCC84LL,  // atan(0.637964775) = 0.567868025078783090
    0x0000000091BADEACLL,  // atan(0.639921722) = 0.569257657141703066
    0x000000009215C770LL,  // atan(0.641878669) = 0.570644822117366557
    0x00000000927086D6LL,  // atan(0.643835616) = 0.572029521245640327
    0x0000000092CB1CE2LL,  // atan(0.645792564) = 0.573411755799810741
    0x000000009325899ALL,  // atan(0.647749511) = 0.574791527086305654
    0x00000000937FCD05LL,  // atan(0.649706458) = 0.576168836444416632
    0x0000000093D9E728LL,  // atan(0.651663405) = 0.577543685246022176
    0x000000009433D808LL,  // atan(0.653620352) = 0.578916074895310717
    0x00000000948D9FADLL,  // atan(0.655577299) = 0.580286006828505951
    0x0000000094E73E1DLL,  // atan(0.657534247) = 0.581653482513591280
    0x000000009540B35DLL,  // atan(0.659491194) = 0.583018503450036030
    0x000000009599FF75LL,  // atan(0.661448141) = 0.584381071168522115
    0x0000000095F3226BLL,  // atan(0.663405088) = 0.585741187230671367
    0x00000000964C1C46LL,  // atan(0.665362035) = 0.587098853228773976
    0x0000000096A4ED0DLL,  // atan(0.667318982) = 0.588454070785517480
    0x0000000096FD94C7LL,  // atan(0.669275930) = 0.589806841553716654
    0x000000009756137BLL,  // atan(0.671232877) = 0.591157167216044388
    0x0000000097AE6932LL,  // atan(0.673189824) = 0.592505049484762791
    0x00000000980695F1LL,  // atan(0.675146771) = 0.593850490101456185
    0x00000000985E99C1LL,  // atan(0.677103718) = 0.595193490836764205
    0x0000000098B674AALL,  // atan(0.679060665) = 0.596534053490115790
    0x00000000990E26B3LL,  // atan(0.681017613) = 0.597872179889464617
    0x000000009965AFE5LL,  // atan(0.682974560) = 0.599207871891024757
    0x0000000099BD1047LL,  // atan(0.684931507) = 0.600541131379007553
    0x000000009A1447E1LL,  // atan(0.686888454) = 0.601871960265360051
    0x000000009A6B56BDLL,  // atan(0.688845401) = 0.603200360489502985
    0x000000009AC23CE2LL,  // atan(0.690802348) = 0.604526334018070877
    0x000000009B18FA59LL,  // atan(0.692759295) = 0.605849882844652687
    0x000000009B6F8F2ALL,  // atan(0.694716243) = 0.607171008989533467
    0x000000009BC5FB5FLL,  // atan(0.696673190) = 0.608489714499436563
    0x000000009C1C3F01LL,  // atan(0.698630137) = 0.609806001447268042
    0x000000009C725A17LL,  // atan(0.700587084) = 0.611119871931860459
    0x000000009CC84CADLL,  // atan(0.702544031) = 0.612431328077718939
    0x000000009D1E16CALL,  // atan(0.704500978) = 0.613740372034767501
    0x000000009D73B878LL,  // atan(0.706457926) = 0.615047005978096917
    0x000000009DC931C0LL,  // atan(0.708414873) = 0.616351232107713032
    0x000000009E1E82ADLL,  // atan(0.710371820) = 0.617653052648286849
    0x000000009E73AB47LL,  // atan(0.712328767) = 0.618952469848904951
    0x000000009EC8AB99LL,  // atan(0.714285714) = 0.620249485982821480
    0x000000009F1D83ACLL,  // atan(0.716242661) = 0.621544103347210886
    0x000000009F72338BLL,  // atan(0.718199609) = 0.622836324262921681
    0x000000009FC6BB3FLL,  // atan(0.720156556) = 0.624126151074231639
    0x00000000A01B1AD2LL,  // atan(0.722113503) = 0.625413586148603984
    0x00000000A06F5250LL,  // atan(0.724070450) = 0.626698631876443923
    0x00000000A0C361C1LL,  // atan(0.726027397) = 0.627981290670857617
    0x00000000A1174932LL,  // atan(0.727984344) = 0.629261564967410925
    0x00000000A16B08ABLL,  // atan(0.729941292) = 0.630539457223890154
    0x00000000A1BEA038LL,  // atan(0.731898239) = 0.631814969920063696
    0x00000000A2120FE4LL,  // atan(0.733855186) = 0.633088105557444214
    0x00000000A26557BALL,  // atan(0.735812133) = 0.634358866659052723
    0x00000000A2B877C3LL,  // atan(0.737769080) = 0.635627255769183885
    0x00000000A30B700DLL,  // atan(0.739726027) = 0.636893275453171093
    0x00000000A35E40A0LL,  // atan(0.741682975) = 0.638156928297154535
    0x00000000A3B0E98ALL,  // atan(0.743639922) = 0.639418216907848946
    0x00000000A4036AD4LL,  // atan(0.745596869) = 0.640677143912313452
    0x00000000A455C48BLL,  // atan(0.747553816) = 0.641933711957721864
    0x00000000A4A7F6B9LL,  // atan(0.749510763) = 0.643187923711134313
    0x00000000A4FA016BLL,  // atan(0.751467710) = 0.644439781859270866
    0x00000000A54BE4ACLL,  // atan(0.753424658) = 0.645689289108284714
    0x00000000A59DA087LL,  // atan(0.755381605) = 0.646936448183537793
    0x00000000A5EF3509LL,  // atan(0.757338552) = 0.648181261829377298
    0x00000000A640A23DLL,  // atan(0.759295499) = 0.649423732808913190
    0x00000000A691E830LL,  // atan(0.761252446) = 0.650663863903796824
    0x00000000A6E306ECLL,  // atan(0.763209393) = 0.651901657914000676
    0x00000000A733FE80LL,  // atan(0.765166341) = 0.653137117657599964
    0x00000000A784CEF5LL,  // atan(0.767123288) = 0.654370245970554598
    0x00000000A7D5785ALL,  // atan(0.769080235) = 0.655601045706492358
    0x00000000A825FABALL,  // atan(0.771037182) = 0.656829519736494283
    0x00000000A8765621LL,  // atan(0.772994129) = 0.658055670948879845
    0x00000000A8C68A9DLL,  // atan(0.774951076) = 0.659279502248994009
    0x00000000A9169839LL,  // atan(0.776908023) = 0.660501016558996068
    0x00000000A9667F02LL,  // atan(0.778864971) = 0.661720216817648255
    0x00000000A9B63F05LL,  // atan(0.780821918) = 0.662937105980106911
    0x00000000AA05D84FLL,  // atan(0.782778865) = 0.664151687017713876
    0x00000000AA554AECLL,  // atan(0.784735812) = 0.665363962917789764
    0x00000000AAA496EALL,  // atan(0.786692759) = 0.666573936683428347
    0x00000000AAF3BC55LL,  // atan(0.788649706) = 0.667781611333291281
    0x00000000AB42BB3BLL,  // atan(0.790606654) = 0.668986989901405260
    0x00000000AB9193A8LL,  // atan(0.792563601) = 0.670190075436959853
    0x00000000ABE045A9LL,  // atan(0.794520548) = 0.671390871004106105
    0x00000000AC2ED14DLL,  // atan(0.796477495) = 0.672589379681756916
    0x00000000AC7D36A0LL,  // atan(0.798434442) = 0.673785604563388651
    0x00000000ACCB75AFLL,  // atan(0.800391389) = 0.674979548756843628
    0x00000000AD198E88LL,  // atan(0.802348337) = 0.676171215384133495
    0x00000000AD678139LL,  // atan(0.804305284) = 0.677360607581245167
    0x00000000ADB54DCELL,  // atan(0.806262231) = 0.678547728497946201
    0x00000000AE02F456LL,  // atan(0.808219178) = 0.679732581297592509
    0x00000000AE5074DELL,  // atan(0.810176125) = 0.680915169156937283
    0x00000000AE9DCF74LL,  // atan(0.812133072) = 0.682095495265940155
    0x00000000AEEB0426LL,  // atan(0.814090020) = 0.683273562827579006
    0x00000000AF381301LL,  // atan(0.816046967) = 0.684449375057661569
    0x00000000AF84FC14LL,  // atan(0.818003914) = 0.685622935184639237
    0x00000000AFD1BF6BLL,  // atan(0.819960861) = 0.686794246449421664
    0x00000000B01E5D16LL,  // atan(0.821917808) = 0.687963312105192126
    0x00000000B06AD522LL,  // atan(0.823874755) = 0.689130135417225342
    0x00000000B0B7279DLL,  // atan(0.825831703) = 0.690294719662704948
    0x00000000B1035496LL,  // atan(0.827788650) = 0.691457068130543528
    0x00000000B14F5C1ALL,  // atan(0.829745597) = 0.692617184121202656
    0x00000000B19B3E38LL,  // atan(0.831702544) = 0.693775070946515138
    0x00000000B1E6FAFELL,  // atan(0.833659491) = 0.694930731929507939
    0x00000000B232927BLL,  // atan(0.835616438) = 0.696084170404226099
    0x00000000B27E04BCLL,  // atan(0.837573386) = 0.697235389715558318
    0x00000000B2C951D0LL,  // atan(0.839530333) = 0.698384393219063537
    0x00000000B31479C7LL,  // atan(0.841487280) = 0.699531184280798524
    0x00000000B35F7CADLL,  // atan(0.843444227) = 0.700675766277146894
    0x00000000B3AA5A92LL,  // atan(0.845401174) = 0.701818142594649252
    0x00000000B3F51384LL,  // atan(0.847358121) = 0.702958316629834434
    0x00000000B43FA792LL,  // atan(0.849315068) = 0.704096291789051865
    0x00000000B48A16CBLL,  // atan(0.851272016) = 0.705232071488305134
    0x00000000B4D4613DLL,  // atan(0.853228963) = 0.706365659153087022
    0x00000000B51E86F7LL,  // atan(0.855185910) = 0.707497058218215513
    0x00000000B5688807LL,  // atan(0.857142857) = 0.708626272127670265
    0x00000000B5B2647ELL,  // atan(0.859099804) = 0.709753304334431845
    0x00000000B5FC1C69LL,  // atan(0.861056751) = 0.710878158300320417
    0x00000000B645AFD7LL,  // atan(0.863013699) = 0.712000837495836647
    0x00000000B68F1ED8LL,  // atan(0.864970646) = 0.713121345400003603
    0x00000000B6D8697ALL,  // atan(0.866927593) = 0.714239685500209331
    0x00000000B7218FCDLL,  // atan(0.868884540) = 0.715355861292051198
    0x00000000B76A91DFLL,  // atan(0.870841487) = 0.716469876279180684
    0x00000000B7B36FBFLL,  // atan(0.872798434) = 0.717581733973150393
    0x00000000B7FC297DLL,  // atan(0.874755382) = 0.718691437893260843
    0x00000000B844BF28LL,  // atan(0.876712329) = 0.719798991566409585
    0x00000000B88D30CFLL,  // atan(0.878669276) = 0.720904398526940438
    0x00000000B8D57E81LL,  // atan(0.880626223) = 0.722007662316495047
    0x00000000B91DA84DLL,  // atan(0.882583170) = 0.723108786483864230
    0x00000000B965AE43LL,  // atan(0.884540117) = 0.724207774584841424
    0x00000000B9AD9072LL,  // atan(0.886497065) = 0.725304630182076915
    0x00000000B9F54EE9LL,  // atan(0.888454012) = 0.726399356844933064
    0x00000000BA3CE9B8LL,  // atan(0.890410959) = 0.727491958149341089
    0x00000000BA8460EELL,  // atan(0.892367906) = 0.728582437677657957
    0x00000000BACBB49ALL,  // atan(0.894324853) = 0.729670799018526051
    0x00000000BB12E4CCLL,  // atan(0.896281800) = 0.730757045766731839
    0x00000000BB59F194LL,  // atan(0.898238748) = 0.731841181523067763
    0x00000000BBA0DB00LL,  // atan(0.900195695) = 0.732923209894193572
    0x00000000BBE7A121LL,  // atan(0.902152642) = 0.734003134492499321
    0x00000000BC2E4406LL,  // atan(0.904109589) = 0.735080958935970030
    0x00000000BC74C3BELL,  // atan(0.906066536) = 0.736156686848050579
    0x00000000BCBB2059LL,  // atan(0.908023483) = 0.737230321857511806
    0x00000000BD0159E7LL,  // atan(0.909980431) = 0.738301867598318173
    0x00000000BD477078LL,  // atan(0.911937378) = 0.739371327709496207
    0x00000000BD8D641ALL,  // atan(0.913894325) = 0.740438705835003819
    0x00000000BDD334DELL,  // atan(0.915851272) = 0.741504005623600859
    0x00000000BE18E2D3LL,  // atan(0.917808219) = 0.742567230728720995
    0x00000000BE5E6E09LL,  // atan(0.919765166) = 0.743628384808343923
    0x00000000BEA3D68FLL,  // atan(0.921722114) = 0.744687471524869360
    0x00000000BEE91C77LL,  // atan(0.923679061) = 0.745744494544992031
    0x00000000BF2E3FCELL,  // atan(0.925636008) = 0.746799457539576883
    0x00000000BF7340A6LL,  // atan(0.927592955) = 0.747852364183536289
    0x00000000BFB81F0DLL,  // atan(0.929549902) = 0.748903218155708039
    0x00000000BFFCDB14LL,  // atan(0.931506849) = 0.749952023138733548
    0x00000000C04174CBLL,  // atan(0.933463796) = 0.750998782818938615
    0x00000000C085EC41LL,  // atan(0.935420744) = 0.752043500886213745
    0x00000000C0CA4186LL,  // atan(0.937377691) = 0.753086181033896240
    0x00000000C10E74AALL,  // atan(0.939334638) = 0.754126826958653185
    0x00000000C15285BELL,  // atan(0.941291585) = 0.755165442360365091
    0x00000000C19674D0LL,  // atan(0.943248532) = 0.756202030942011438
    0x00000000C1DA41F0LL,  // atan(0.945205479) = 0.757236596409555873
    0x00000000C21DED30LL,  // atan(0.947162427) = 0.758269142471833746
    0x00000000C261769ELL,  // atan(0.949119374) = 0.759299672840439421
    0x00000000C2A4DE4BLL,  // atan(0.951076321) = 0.760328191229615813
    0x00000000C2E82446LL,  // atan(0.953033268) = 0.761354701356143360
    0x00000000C32B48A0LL,  // atan(0.954990215) = 0.762379206939231890
    0x00000000C36E4B69LL,  // atan(0.956947162) = 0.763401711700411489
    0x00000000C3B12CB0LL,  // atan(0.958904110) = 0.764422219363425581
    0x00000000C3F3EC86LL,  // atan(0.960861057) = 0.765440733654124905
    0x00000000C4368AFALL,  // atan(0.962818004) = 0.766457258300361821
    0x00000000C479081CLL,  // atan(0.964774951) = 0.767471797031885727
    0x00000000C4BB63FELL,  // atan(0.966731898) = 0.768484353580240254
    0x00000000C4FD9EADLL,  // atan(0.968688845) = 0.769494931678659899
    0x00000000C53FB83CLL,  // atan(0.970645793) = 0.770503535061969114
    0x00000000C581B0B9LL,  // atan(0.972602740) = 0.771510167466481267
    0x00000000C5C38835LL,  // atan(0.974559687) = 0.772514832629898951
    0x00000000C6053EC0LL,  // atan(0.976516634) = 0.773517534291215392
    0x00000000C646D46ALL,  // atan(0.978473581) = 0.774518276190615973
    0x00000000C6884943LL,  // atan(0.980430528) = 0.775517062069381757
    0x00000000C6C99D5ALL,  // atan(0.982387476) = 0.776513895669793008
    0x00000000C70AD0C1LL,  // atan(0.984344423) = 0.777508780735034266
    0x00000000C74BE387LL,  // atan(0.986301370) = 0.778501721009099867
    0x00000000C78CD5BCLL,  // atan(0.988258317) = 0.779492720236700243
    0x00000000C7CDA771LL,  // atan(0.990215264) = 0.780481782163169990
    0x00000000C80E58B5LL,  // atan(0.992172211) = 0.781468910534375505
    0x00000000C84EE999LL,  // atan(0.994129159) = 0.782454109096624717
    0x00000000C88F5A2CLL,  // atan(0.996086106) = 0.783437381596576610
    0x00000000C8CFAA7FLL,  // atan(0.998043053) = 0.784418731781152623
    0x00000000C90FDAA2LL   // atan(1.000000000) = 0.785398163397448279
};

// Fast lookup atan(x) with linear interpolation between table entries
// Input x is in fixed-point format with specified fraction bits representing a value in [-1,1]
// Output is in fixed-point format with the same fraction bits representing atan(x)
// Precision: ~1.5e-5 when fraction_bits=32
inline constexpr auto LookupAtanFast(int64_t x, int input_fraction_bits) noexcept -> int64_t {
    // Constants
    constexpr int kOutputFractionBits = 32;  // Internal calculation format
    constexpr int64_t kOne = 1LL << kOutputFractionBits;

    // Handle negative input
    bool is_negative = false;
    if (x < 0) {
        x = -x;
        is_negative = true;
    }

    // Convert input to internal format if needed
    if (input_fraction_bits != kOutputFractionBits) {
        if (input_fraction_bits < kOutputFractionBits) {
            x <<= (kOutputFractionBits - input_fraction_bits);
        } else {
            x >>= (input_fraction_bits - kOutputFractionBits);
        }
    }

    // 1. Ensure x is in [0,1] range
    if (x <= 0) {
        return 0;
    }
    if (x >= kOne) {
        // Return the maximum value (atan(1) = pi/4)
        int64_t result = kAtanLut[kAtanLut.size() - 1];
        if (input_fraction_bits != kOutputFractionBits) {
            if (input_fraction_bits < kOutputFractionBits) {
                result >>= (kOutputFractionBits - input_fraction_bits);
            } else {
                result <<= (input_fraction_bits - kOutputFractionBits);
            }
        }
        return is_negative ? -result : result;
    }

    // 2. Scale x to table index
    const int64_t scale = static_cast<int64_t>(kAtanLut.size() - 1);
    const int64_t idx_scaled = Primitives::Fixed64Mul(x, scale << kOutputFractionBits, kOutputFractionBits);
    const int64_t idx = idx_scaled >> kOutputFractionBits;
    const int64_t t = idx_scaled & ((1LL << kOutputFractionBits) - 1);  // Fractional part [0,1)

    // 3. Clamp index to valid range
    if (idx >= static_cast<int64_t>(kAtanLut.size()) - 1) {
        // Return the maximum value (atan(1) = pi/4)
        int64_t result = kAtanLut[kAtanLut.size() - 1];
        if (input_fraction_bits != kOutputFractionBits) {
            if (input_fraction_bits < kOutputFractionBits) {
                result >>= (kOutputFractionBits - input_fraction_bits);
            } else {
                result <<= (input_fraction_bits - kOutputFractionBits);
            }
        }
        return is_negative ? -result : result;
    }

    // 4. Get table values for interpolation
    const int64_t y0 = kAtanLut[idx];
    const int64_t y1 = kAtanLut[idx + 1];

    // 5. Linear interpolation
    int64_t result = y0 + Primitives::Fixed64Mul(y1 - y0, t, kOutputFractionBits);

    // 6. Convert result back to input format if needed
    if (input_fraction_bits != kOutputFractionBits) {
        if (input_fraction_bits < kOutputFractionBits) {
            result >>= (kOutputFractionBits - input_fraction_bits);
        } else {
            result <<= (input_fraction_bits - kOutputFractionBits);
        }
    }

    // Apply sign
    return is_negative ? -result : result;
}

}  // namespace math::fp::detail