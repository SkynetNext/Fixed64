#pragma once

#include <stdint.h>
#include <array>
#include "primitives.h"

// Atan lookup table with 512 entries
// Covers the range [0,1] with values in Q31.32 format
// Generated with mpmath library at 100 digits precision

namespace math::fp::detail {
// Table maps x in [0,1] to atan(x)
// Values stored in Q31.32 fixed-point format
inline constexpr std::array<int64_t, 512> kAtanLut = {
    0x0000000000000000LL,  // atan(0.00000000000) = 0.00000000000
    0x0000000000804015LL,  // atan(0.00195694716) = 0.00195694466
    0x0000000001007FEALL,  // atan(0.00391389432) = 0.00391387434
    0x000000000180BF3ELL,  // atan(0.00587084149) = 0.00587077404
    0x000000000200FDD1LL,  // atan(0.00782778865) = 0.00782762877
    0x0000000002813B63LL,  // atan(0.00978473581) = 0.00978442356
    0x00000000030177B3LL,  // atan(0.01174168297) = 0.01174114342
    0x000000000381B280LL,  // atan(0.01369863014) = 0.01369777337
    0x000000000401EB8BLL,  // atan(0.01565557730) = 0.01565429844
    0x0000000004822294LL,  // atan(0.01761252446) = 0.01761070366
    0x0000000005025759LL,  // atan(0.01956947162) = 0.01956697406
    0x000000000582899BLL,  // atan(0.02152641879) = 0.02152309469
    0x000000000602B91ALL,  // atan(0.02348336595) = 0.02347905060
    0x000000000682E595LL,  // atan(0.02544031311) = 0.02543482684
    0x0000000007030ECCLL,  // atan(0.02739726027) = 0.02739040847
    0x000000000783347FLL,  // atan(0.02935420744) = 0.02934578058
    0x000000000803566FLL,  // atan(0.03131115460) = 0.03130092825
    0x000000000883745ALL,  // atan(0.03326810176) = 0.03325583656
    0x0000000009038E01LL,  // atan(0.03522504892) = 0.03521049063
    0x000000000983A325LL,  // atan(0.03718199609) = 0.03716487557
    0x000000000A03B384LL,  // atan(0.03913894325) = 0.03911897651
    0x000000000A83BEE0LL,  // atan(0.04109589041) = 0.04107277859
    0x000000000B03C4F9LL,  // atan(0.04305283757) = 0.04302626697
    0x000000000B83C58FLL,  // atan(0.04500978474) = 0.04497942681
    0x000000000C03C062LL,  // atan(0.04696673190) = 0.04693224330
    0x000000000C83B532LL,  // atan(0.04892367906) = 0.04888470165
    0x000000000D03A3C1LL,  // atan(0.05088062622) = 0.05083678706
    0x000000000D838BCFLL,  // atan(0.05283757339) = 0.05278848478
    0x000000000E036D1DLL,  // atan(0.05479452055) = 0.05473978005
    0x000000000E83476ALL,  // atan(0.05675146771) = 0.05669065814
    0x000000000F031A79LL,  // atan(0.05870841487) = 0.05864110435
    0x000000000F82E60ALL,  // atan(0.06066536204) = 0.06059110398
    0x000000001002A9DDLL,  // atan(0.06262230920) = 0.06254064235
    0x00000000108265B5LL,  // atan(0.06457925636) = 0.06448970483
    0x0000000011021951LL,  // atan(0.06653620352) = 0.06643827678
    0x000000001181C475LL,  // atan(0.06849315068) = 0.06838634359
    0x00000000120166E0LL,  // atan(0.07045009785) = 0.07033389068
    0x0000000012810054LL,  // atan(0.07240704501) = 0.07228090350
    0x0000000013009093LL,  // atan(0.07436399217) = 0.07422736750
    0x000000001380175FLL,  // atan(0.07632093933) = 0.07617326817
    0x0000000013FF9479LL,  // atan(0.07827788650) = 0.07811859104
    0x00000000147F07A4LL,  // atan(0.08023483366) = 0.08006332163
    0x0000000014FE70A0LL,  // atan(0.08219178082) = 0.08200744553
    0x00000000157DCF31LL,  // atan(0.08414872798) = 0.08395094831
    0x0000000015FD2318LL,  // atan(0.08610567515) = 0.08589381561
    0x00000000167C6C19LL,  // atan(0.08806262231) = 0.08783603308
    0x0000000016FBA9F5LL,  // atan(0.09001956947) = 0.08977758639
    0x00000000177ADC6FLL,  // atan(0.09197651663) = 0.09171846126
    0x0000000017FA034ALL,  // atan(0.09393346380) = 0.09365864343
    0x0000000018791E49LL,  // atan(0.09589041096) = 0.09559811866
    0x0000000018F82D2ELL,  // atan(0.09784735812) = 0.09753687277
    0x0000000019772FBELL,  // atan(0.09980430528) = 0.09947489159
    0x0000000019F625BALL,  // atan(0.10176125245) = 0.10141216099
    0x000000001A750EE8LL,  // atan(0.10371819961) = 0.10334866687
    0x000000001AF3EB09LL,  // atan(0.10567514677) = 0.10528439516
    0x000000001B72B9E3LL,  // atan(0.10763209393) = 0.10721933184
    0x000000001BF17B39LL,  // atan(0.10958904110) = 0.10915346291
    0x000000001C702ECFLL,  // atan(0.11154598826) = 0.11108677441
    0x000000001CEED468LL,  // atan(0.11350293542) = 0.11301925243
    0x000000001D6D6BCBLL,  // atan(0.11545988258) = 0.11495088307
    0x000000001DEBF4BALL,  // atan(0.11741682975) = 0.11688165248
    0x000000001E6A6EFCLL,  // atan(0.11937377691) = 0.11881154687
    0x000000001EE8DA54LL,  // atan(0.12133072407) = 0.12074055246
    0x000000001F673687LL,  // atan(0.12328767123) = 0.12266865550
    0x000000001FE5835CLL,  // atan(0.12524461840) = 0.12459584233
    0x000000002063C096LL,  // atan(0.12720156556) = 0.12652209927
    0x0000000020E1EDFCLL,  // atan(0.12915851272) = 0.12844741272
    0x0000000021600B54LL,  // atan(0.13111545988) = 0.13037176911
    0x0000000021DE1863LL,  // atan(0.13307240705) = 0.13229515491
    0x00000000225C14F0LL,  // atan(0.13502935421) = 0.13421755664
    0x0000000022DA00C0LL,  // atan(0.13698630137) = 0.13613896085
    0x000000002357DB9ALL,  // atan(0.13894324853) = 0.13805935415
    0x0000000023D5A546LL,  // atan(0.14090019569) = 0.13997872317
    0x0000000024535D88LL,  // atan(0.14285714286) = 0.14189705460
    0x0000000024D1042ALL,  // atan(0.14481409002) = 0.14381433519
    0x00000000254E98F1LL,  // atan(0.14677103718) = 0.14573055171
    0x0000000025CC1BA6LL,  // atan(0.14872798434) = 0.14764569098
    0x0000000026498C0FLL,  // atan(0.15068493151) = 0.14955973987
    0x0000000026C6E9F5LL,  // atan(0.15264187867) = 0.15147268531
    0x0000000027443520LL,  // atan(0.15459882583) = 0.15338451426
    0x0000000027C16D58LL,  // atan(0.15655577299) = 0.15529521374
    0x00000000283E9265LL,  // atan(0.15851272016) = 0.15720477080
    0x0000000028BBA410LL,  // atan(0.16046966732) = 0.15911317256
    0x000000002938A222LL,  // atan(0.16242661448) = 0.16102040617
    0x0000000029B58C64LL,  // atan(0.16438356164) = 0.16292645885
    0x000000002A32629FLL,  // atan(0.16634050881) = 0.16483131786
    0x000000002AAF249DLL,  // atan(0.16829745597) = 0.16673497050
    0x000000002B2BD227LL,  // atan(0.17025440313) = 0.16863740414
    0x000000002BA86B08LL,  // atan(0.17221135029) = 0.17053860620
    0x000000002C24EF09LL,  // atan(0.17416829746) = 0.17243856413
    0x000000002CA15DF5LL,  // atan(0.17612524462) = 0.17433726545
    0x000000002D1DB797LL,  // atan(0.17808219178) = 0.17623469774
    0x000000002D99FBB9LL,  // atan(0.18003913894) = 0.17813084861
    0x000000002E162A26LL,  // atan(0.18199608611) = 0.18002570575
    0x000000002E9242AALL,  // atan(0.18395303327) = 0.18191925688
    0x000000002F0E4511LL,  // atan(0.18590998043) = 0.18381148979
    0x000000002F8A3125LL,  // atan(0.18786692759) = 0.18570239232
    0x00000000300606B4LL,  // atan(0.18982387476) = 0.18759195237
    0x000000003081C589LL,  // atan(0.19178082192) = 0.18948015788
    0x0000000030FD6D71LL,  // atan(0.19373776908) = 0.19136699686
    0x000000003178FE38LL,  // atan(0.19569471624) = 0.19325245738
    0x0000000031F477ACLL,  // atan(0.19765166341) = 0.19513652755
    0x00000000326FD999LL,  // atan(0.19960861057) = 0.19701919555
    0x0000000032EB23CELL,  // atan(0.20156555773) = 0.19890044961
    0x0000000033665617LL,  // atan(0.20352250489) = 0.20078027803
    0x0000000033E17044LL,  // atan(0.20547945205) = 0.20265866915
    0x00000000345C7221LL,  // atan(0.20743639922) = 0.20453561138
    0x0000000034D75B7ELL,  // atan(0.20939334638) = 0.20641109319
    0x0000000035522C2ALL,  // atan(0.21135029354) = 0.20828510311
    0x0000000035CCE3F2LL,  // atan(0.21330724070) = 0.21015762971
    0x00000000364782A7LL,  // atan(0.21526418787) = 0.21202866165
    0x0000000036C20818LL,  // atan(0.21722113503) = 0.21389818763
    0x00000000373C7415LL,  // atan(0.21917808219) = 0.21576619641
    0x0000000037B6C66DLL,  // atan(0.22113502935) = 0.21763267681
    0x000000003830FEF1LL,  // atan(0.22309197652) = 0.21949761774
    0x0000000038AB1D72LL,  // atan(0.22504892368) = 0.22136100812
    0x00000000392521C0LL,  // atan(0.22700587084) = 0.22322283698
    0x00000000399F0BACLL,  // atan(0.22896281800) = 0.22508309337
    0x000000003A18DB08LL,  // atan(0.23091976517) = 0.22694176645
    0x000000003A928FA6LL,  // atan(0.23287671233) = 0.22879884539
    0x000000003B0C2956LL,  // atan(0.23483365949) = 0.23065431945
    0x000000003B85A7ECLL,  // atan(0.23679060665) = 0.23250817797
    0x000000003BFF0B39LL,  // atan(0.23874755382) = 0.23436041031
    0x000000003C785311LL,  // atan(0.24070450098) = 0.23621100593
    0x000000003CF17F46LL,  // atan(0.24266144814) = 0.23805995434
    0x000000003D6A8FABLL,  // atan(0.24461839530) = 0.23990724510
    0x000000003DE38415LL,  // atan(0.24657534247) = 0.24175286786
    0x000000003E5C5C56LL,  // atan(0.24853228963) = 0.24359681233
    0x000000003ED51843LL,  // atan(0.25048923679) = 0.24543906825
    0x000000003F4DB7B0LL,  // atan(0.25244618395) = 0.24727962547
    0x000000003FC63A72LL,  // atan(0.25440313112) = 0.24911847388
    0x00000000403EA05DLL,  // atan(0.25636007828) = 0.25095560345
    0x0000000040B6E947LL,  // atan(0.25831702544) = 0.25279100419
    0x00000000412F1506LL,  // atan(0.26027397260) = 0.25462466619
    0x0000000041A7236ELL,  // atan(0.26223091977) = 0.25645657963
    0x00000000421F1456LL,  // atan(0.26418786693) = 0.25828673470
    0x000000004296E794LL,  // atan(0.26614481409) = 0.26011512172
    0x00000000430E9D00LL,  // atan(0.26810176125) = 0.26194173102
    0x000000004386346FLL,  // atan(0.27005870841) = 0.26376655303
    0x0000000043FDADB8LL,  // atan(0.27201565558) = 0.26558957823
    0x00000000447508B4LL,  // atan(0.27397260274) = 0.26741079718
    0x0000000044EC453ALL,  // atan(0.27592954990) = 0.26923020050
    0x0000000045636321LL,  // atan(0.27788649706) = 0.27104777888
    0x0000000045DA6243LL,  // atan(0.27984344423) = 0.27286352306
    0x0000000046514278LL,  // atan(0.28180039139) = 0.27467742388
    0x0000000046C80398LL,  // atan(0.28375733855) = 0.27648947221
    0x00000000473EA57DLL,  // atan(0.28571428571) = 0.27829965901
    0x0000000047B52801LL,  // atan(0.28767123288) = 0.28010797530
    0x00000000482B8AFCLL,  // atan(0.28962818004) = 0.28191441217
    0x0000000048A1CE49LL,  // atan(0.29158512720) = 0.28371896079
    0x000000004917F1C3LL,  // atan(0.29354207436) = 0.28552161237
    0x00000000498DF543LL,  // atan(0.29549902153) = 0.28732235821
    0x000000004A03D8A6LL,  // atan(0.29745596869) = 0.28912118967
    0x000000004A799BC5LL,  // atan(0.29941291585) = 0.29091809818
    0x000000004AEF3E7DLL,  // atan(0.30136986301) = 0.29271307522
    0x000000004B64C0A9LL,  // atan(0.30332681018) = 0.29450611238
    0x000000004BDA2225LL,  // atan(0.30528375734) = 0.29629720128
    0x000000004C4F62CELL,  // atan(0.30724070450) = 0.29808633362
    0x000000004CC48280LL,  // atan(0.30919765166) = 0.29987350117
    0x000000004D398118LL,  // atan(0.31115459883) = 0.30165869576
    0x000000004DAE5E74LL,  // atan(0.31311154599) = 0.30344190932
    0x000000004E231A71LL,  // atan(0.31506849315) = 0.30522313379
    0x000000004E97B4EDLL,  // atan(0.31702544031) = 0.30700236124
    0x000000004F0C2DC5LL,  // atan(0.31898238748) = 0.30877958377
    0x000000004F8084D9LL,  // atan(0.32093933464) = 0.31055479356
    0x000000004FF4BA07LL,  // atan(0.32289628180) = 0.31232798285
    0x000000005068CD2FLL,  // atan(0.32485322896) = 0.31409914397
    0x0000000050DCBE2ELL,  // atan(0.32681017613) = 0.31586826930
    0x0000000051508CE5LL,  // atan(0.32876712329) = 0.31763535129
    0x0000000051C43934LL,  // atan(0.33072407045) = 0.31940038246
    0x000000005237C2FCLL,  // atan(0.33268101761) = 0.32116335540
    0x0000000052AB2A1BLL,  // atan(0.33463796477) = 0.32292426278
    0x00000000531E6E74LL,  // atan(0.33659491194) = 0.32468309731
    0x0000000053918FE7LL,  // atan(0.33855185910) = 0.32643985179
    0x0000000054048E56LL,  // atan(0.34050880626) = 0.32819451910
    0x00000000547769A2LL,  // atan(0.34246575342) = 0.32994709215
    0x0000000054EA21ADLL,  // atan(0.34442270059) = 0.33169756395
    0x00000000555CB659LL,  // atan(0.34637964775) = 0.33344592756
    0x0000000055CF278ALL,  // atan(0.34833659491) = 0.33519217613
    0x0000000056417521LL,  // atan(0.35029354207) = 0.33693630286
    0x0000000056B39F02LL,  // atan(0.35225048924) = 0.33867830103
    0x000000005725A511LL,  // atan(0.35420743640) = 0.34041816396
    0x0000000057978730LL,  // atan(0.35616438356) = 0.34215588508
    0x0000000058094544LL,  // atan(0.35812133072) = 0.34389145786
    0x00000000587ADF32LL,  // atan(0.36007827789) = 0.34562487585
    0x0000000058EC54DDLL,  // atan(0.36203522505) = 0.34735613265
    0x00000000595DA62BLL,  // atan(0.36399217221) = 0.34908522196
    0x0000000059CED301LL,  // atan(0.36594911937) = 0.35081213751
    0x000000005A3FDB44LL,  // atan(0.36790606654) = 0.35253687312
    0x000000005AB0BEDALL,  // atan(0.36986301370) = 0.35425942268
    0x000000005B217DA9LL,  // atan(0.37181996086) = 0.35597978014
    0x000000005B921798LL,  // atan(0.37377690802) = 0.35769793951
    0x000000005C028C8CLL,  // atan(0.37573385519) = 0.35941389488
    0x000000005C72DC6DLL,  // atan(0.37769080235) = 0.36112764041
    0x000000005CE30722LL,  // atan(0.37964774951) = 0.36283917031
    0x000000005D530C92LL,  // atan(0.38160469667) = 0.36454847886
    0x000000005DC2ECA6LL,  // atan(0.38356164384) = 0.36625556043
    0x000000005E32A744LL,  // atan(0.38551859100) = 0.36796040943
    0x000000005EA23C56LL,  // atan(0.38747553816) = 0.36966302034
    0x000000005F11ABC5LL,  // atan(0.38943248532) = 0.37136338773
    0x000000005F80F578LL,  // atan(0.39138943249) = 0.37306150620
    0x000000005FF0195ALL,  // atan(0.39334637965) = 0.37475737045
    0x00000000605F1753LL,  // atan(0.39530332681) = 0.37645097521
    0x0000000060CDEF4DLL,  // atan(0.39726027397) = 0.37814231532
    0x00000000613CA133LL,  // atan(0.39921722114) = 0.37983138565
    0x0000000061AB2CEELL,  // atan(0.40117416830) = 0.38151818115
    0x000000006219926ALL,  // atan(0.40313111546) = 0.38320269683
    0x000000006287D191LL,  // atan(0.40508806262) = 0.38488492778
    0x0000000062F5EA4ELL,  // atan(0.40704500978) = 0.38656486912
    0x000000006363DC8DLL,  // atan(0.40900195695) = 0.38824251608
    0x0000000063D1A839LL,  // atan(0.41095890411) = 0.38991786393
    0x00000000643F4D3FLL,  // atan(0.41291585127) = 0.39159090800
    0x0000000064ACCB8ALL,  // atan(0.41487279843) = 0.39326164370
    0x00000000651A2307LL,  // atan(0.41682974560) = 0.39493006648
    0x00000000658753A3LL,  // atan(0.41878669276) = 0.39659617189
    0x0000000065F45D4CLL,  // atan(0.42074363992) = 0.39825995552
    0x0000000066613FEDLL,  // atan(0.42270058708) = 0.39992141301
    0x0000000066CDFB76LL,  // atan(0.42465753425) = 0.40158054011
    0x00000000673A8FD3LL,  // atan(0.42661448141) = 0.40323733258
    0x0000000067A6FCF4LL,  // atan(0.42857142857) = 0.40489178629
    0x00000000681342C6LL,  // atan(0.43052837573) = 0.40654389713
    0x00000000687F6138LL,  // atan(0.43248532290) = 0.40819366108
    0x0000000068EB583ALL,  // atan(0.43444227006) = 0.40984107418
    0x00000000695727B9LL,  // atan(0.43639921722) = 0.41148613253
    0x0000000069C2CFA7LL,  // atan(0.43835616438) = 0.41312883228
    0x000000006A2E4FF3LL,  // atan(0.44031311155) = 0.41476916966
    0x000000006A99A88CLL,  // atan(0.44227005871) = 0.41640714096
    0x000000006B04D963LL,  // atan(0.44422700587) = 0.41804274251
    0x000000006B6FE269LL,  // atan(0.44618395303) = 0.41967597073
    0x000000006BDAC38ELL,  // atan(0.44814090020) = 0.42130682208
    0x000000006C457CC4LL,  // atan(0.45009784736) = 0.42293529310
    0x000000006CB00DFBLL,  // atan(0.45205479452) = 0.42456138036
    0x000000006D1A7726LL,  // atan(0.45401174168) = 0.42618508053
    0x000000006D84B837LL,  // atan(0.45596868885) = 0.42780639031
    0x000000006DEED11FLL,  // atan(0.45792563601) = 0.42942530647
    0x000000006E58C1D1LL,  // atan(0.45988258317) = 0.43104182584
    0x000000006EC28A3FLL,  // atan(0.46183953033) = 0.43265594531
    0x000000006F2C2A5DLL,  // atan(0.46379647750) = 0.43426766183
    0x000000006F95A21DLL,  // atan(0.46575342466) = 0.43587697241
    0x000000006FFEF173LL,  // atan(0.46771037182) = 0.43748387410
    0x0000000070681853LL,  // atan(0.46966731898) = 0.43908836405
    0x0000000070D116B0LL,  // atan(0.47162426614) = 0.44069043942
    0x000000007139EC7FLL,  // atan(0.47358121331) = 0.44229009746
    0x0000000071A299B4LL,  // atan(0.47553816047) = 0.44388733547
    0x00000000720B1E44LL,  // atan(0.47749510763) = 0.44548215081
    0x0000000072737A23LL,  // atan(0.47945205479) = 0.44707454089
    0x0000000072DBAD48LL,  // atan(0.48140900196) = 0.44866450318
    0x000000007343B7A6LL,  // atan(0.48336594912) = 0.45025203520
    0x0000000073AB9933LL,  // atan(0.48532289628) = 0.45183713455
    0x00000000741351E7LL,  // atan(0.48727984344) = 0.45341979886
    0x00000000747AE1B6LL,  // atan(0.48923679061) = 0.45500002582
    0x0000000074E24897LL,  // atan(0.49119373777) = 0.45657781320
    0x0000000075498681LL,  // atan(0.49315068493) = 0.45815315880
    0x0000000075B09B6ALL,  // atan(0.49510763209) = 0.45972606048
    0x000000007617874ALL,  // atan(0.49706457926) = 0.46129651615
    0x00000000767E4A18LL,  // atan(0.49902152642) = 0.46286452380
    0x0000000076E4E3CBLL,  // atan(0.50097847358) = 0.46443008145
    0x00000000774B545BLL,  // atan(0.50293542074) = 0.46599318719
    0x0000000077B19BC0LL,  // atan(0.50489236791) = 0.46755383913
    0x000000007817B9F2LL,  // atan(0.50684931507) = 0.46911203549
    0x00000000787DAEEALL,  // atan(0.50880626223) = 0.47066777449
    0x0000000078E37AA1LL,  // atan(0.51076320939) = 0.47222105443
    0x0000000079491D0FLL,  // atan(0.51272015656) = 0.47377187366
    0x0000000079AE962DLL,  // atan(0.51467710372) = 0.47532023059
    0x000000007A13E5F5LL,  // atan(0.51663405088) = 0.47686612366
    0x000000007A790C61LL,  // atan(0.51859099804) = 0.47840955139
    0x000000007ADE096ALL,  // atan(0.52054794521) = 0.47995051232
    0x000000007B42DD0ALL,  // atan(0.52250489237) = 0.48148900507
    0x000000007BA7873BLL,  // atan(0.52446183953) = 0.48302502829
    0x000000007C0C07F9LL,  // atan(0.52641878669) = 0.48455858070
    0x000000007C705F3DLL,  // atan(0.52837573386) = 0.48608966106
    0x000000007CD48D02LL,  // atan(0.53033268102) = 0.48761826818
    0x000000007D389144LL,  // atan(0.53228962818) = 0.48914440092
    0x000000007D9C6BFFLL,  // atan(0.53424657534) = 0.49066805819
    0x000000007E001D2CLL,  // atan(0.53620352250) = 0.49218923895
    0x000000007E63A4C9LL,  // atan(0.53816046967) = 0.49370794222
    0x000000007EC702D1LL,  // atan(0.54011741683) = 0.49522416705
    0x000000007F2A3741LL,  // atan(0.54207436399) = 0.49673791255
    0x000000007F8D4214LL,  // atan(0.54403131115) = 0.49824917788
    0x000000007FF02347LL,  // atan(0.54598825832) = 0.49975796223
    0x000000008052DAD8LL,  // atan(0.54794520548) = 0.50126426487
    0x0000000080B568C2LL,  // atan(0.54990215264) = 0.50276808509
    0x000000008117CD04LL,  // atan(0.55185909980) = 0.50426942224
    0x00000000817A079BLL,  // atan(0.55381604697) = 0.50576827571
    0x0000000081DC1884LL,  // atan(0.55577299413) = 0.50726464495
    0x00000000823DFFBDLL,  // atan(0.55772994129) = 0.50875852943
    0x00000000829FBD44LL,  // atan(0.55968688845) = 0.51024992869
    0x0000000083015117LL,  // atan(0.56164383562) = 0.51173884232
    0x000000008362BB35LL,  // atan(0.56360078278) = 0.51322526992
    0x0000000083C3FB9CLL,  // atan(0.56555772994) = 0.51470921118
    0x000000008425124CLL,  // atan(0.56751467710) = 0.51619066581
    0x000000008485FF42LL,  // atan(0.56947162427) = 0.51766963356
    0x0000000084E6C27ELL,  // atan(0.57142857143) = 0.51914611425
    0x0000000085475C00LL,  // atan(0.57338551859) = 0.52062010770
    0x0000000085A7CBC6LL,  // atan(0.57534246575) = 0.52209161383
    0x00000000860811D2LL,  // atan(0.57729941292) = 0.52356063255
    0x0000000086682E22LL,  // atan(0.57925636008) = 0.52502716386
    0x0000000086C820B6LL,  // atan(0.58121330724) = 0.52649120776
    0x000000008727E990LL,  // atan(0.58317025440) = 0.52795276432
    0x00000000878788AFLL,  // atan(0.58512720157) = 0.52941183365
    0x0000000087E6FE14LL,  // atan(0.58708414873) = 0.53086841589
    0x00000000884649C0LL,  // atan(0.58904109589) = 0.53232251123
    0x0000000088A56BB4LL,  // atan(0.59099804305) = 0.53377411991
    0x00000000890463F1LL,  // atan(0.59295499022) = 0.53522324219
    0x0000000089633278LL,  // atan(0.59491193738) = 0.53666987839
    0x0000000089C1D74BLL,  // atan(0.59686888454) = 0.53811402885
    0x000000008A20526CLL,  // atan(0.59882583170) = 0.53955569398
    0x000000008A7EA3DBLL,  // atan(0.60078277886) = 0.54099487420
    0x000000008ADCCB9DLL,  // atan(0.60273972603) = 0.54243156999
    0x000000008B3AC9B2LL,  // atan(0.60469667319) = 0.54386578186
    0x000000008B989E1DLL,  // atan(0.60665362035) = 0.54529751036
    0x000000008BF648E1LL,  // atan(0.60861056751) = 0.54672675608
    0x000000008C53CA00LL,  // atan(0.61056751468) = 0.54815351965
    0x000000008CB1217DLL,  // atan(0.61252446184) = 0.54957780174
    0x000000008D0E4F5BLL,  // atan(0.61448140900) = 0.55099960305
    0x000000008D6B539DLL,  // atan(0.61643835616) = 0.55241892432
    0x000000008DC82E47LL,  // atan(0.61839530333) = 0.55383576634
    0x000000008E24DF5DLL,  // atan(0.62035225049) = 0.55525012991
    0x000000008E8166E1LL,  // atan(0.62230919765) = 0.55666201590
    0x000000008EDDC4D8LL,  // atan(0.62426614481) = 0.55807142519
    0x000000008F39F945LL,  // atan(0.62622309198) = 0.55947835872
    0x000000008F96042DLL,  // atan(0.62818003914) = 0.56088281743
    0x000000008FF1E595LL,  // atan(0.63013698630) = 0.56228480234
    0x00000000904D9D7FLL,  // atan(0.63209393346) = 0.56368431447
    0x0000000090A92BF2LL,  // atan(0.63405088063) = 0.56508135490
    0x00000000910490F2LL,  // atan(0.63600782779) = 0.56647592472
    0x00000000915FCC84LL,  // atan(0.63796477495) = 0.56786802508
    0x0000000091BADEACLL,  // atan(0.63992172211) = 0.56925765714
    0x000000009215C770LL,  // atan(0.64187866928) = 0.57064482212
    0x00000000927086D6LL,  // atan(0.64383561644) = 0.57202952125
    0x0000000092CB1CE2LL,  // atan(0.64579256360) = 0.57341175580
    0x000000009325899ALL,  // atan(0.64774951076) = 0.57479152709
    0x00000000937FCD05LL,  // atan(0.64970645793) = 0.57616883644
    0x0000000093D9E728LL,  // atan(0.65166340509) = 0.57754368525
    0x000000009433D808LL,  // atan(0.65362035225) = 0.57891607490
    0x00000000948D9FADLL,  // atan(0.65557729941) = 0.58028600683
    0x0000000094E73E1DLL,  // atan(0.65753424658) = 0.58165348251
    0x000000009540B35DLL,  // atan(0.65949119374) = 0.58301850345
    0x000000009599FF75LL,  // atan(0.66144814090) = 0.58438107117
    0x0000000095F3226BLL,  // atan(0.66340508806) = 0.58574118723
    0x00000000964C1C46LL,  // atan(0.66536203523) = 0.58709885323
    0x0000000096A4ED0DLL,  // atan(0.66731898239) = 0.58845407079
    0x0000000096FD94C7LL,  // atan(0.66927592955) = 0.58980684155
    0x000000009756137BLL,  // atan(0.67123287671) = 0.59115716722
    0x0000000097AE6932LL,  // atan(0.67318982387) = 0.59250504948
    0x00000000980695F1LL,  // atan(0.67514677104) = 0.59385049010
    0x00000000985E99C1LL,  // atan(0.67710371820) = 0.59519349084
    0x0000000098B674AALL,  // atan(0.67906066536) = 0.59653405349
    0x00000000990E26B3LL,  // atan(0.68101761252) = 0.59787217989
    0x000000009965AFE5LL,  // atan(0.68297455969) = 0.59920787189
    0x0000000099BD1047LL,  // atan(0.68493150685) = 0.60054113138
    0x000000009A1447E1LL,  // atan(0.68688845401) = 0.60187196027
    0x000000009A6B56BDLL,  // atan(0.68884540117) = 0.60320036049
    0x000000009AC23CE2LL,  // atan(0.69080234834) = 0.60452633402
    0x000000009B18FA59LL,  // atan(0.69275929550) = 0.60584988284
    0x000000009B6F8F2ALL,  // atan(0.69471624266) = 0.60717100899
    0x000000009BC5FB5FLL,  // atan(0.69667318982) = 0.60848971450
    0x000000009C1C3F01LL,  // atan(0.69863013699) = 0.60980600145
    0x000000009C725A17LL,  // atan(0.70058708415) = 0.61111987193
    0x000000009CC84CADLL,  // atan(0.70254403131) = 0.61243132808
    0x000000009D1E16CALL,  // atan(0.70450097847) = 0.61374037203
    0x000000009D73B878LL,  // atan(0.70645792564) = 0.61504700598
    0x000000009DC931C0LL,  // atan(0.70841487280) = 0.61635123211
    0x000000009E1E82ADLL,  // atan(0.71037181996) = 0.61765305265
    0x000000009E73AB47LL,  // atan(0.71232876712) = 0.61895246985
    0x000000009EC8AB99LL,  // atan(0.71428571429) = 0.62024948598
    0x000000009F1D83ACLL,  // atan(0.71624266145) = 0.62154410335
    0x000000009F72338BLL,  // atan(0.71819960861) = 0.62283632426
    0x000000009FC6BB3FLL,  // atan(0.72015655577) = 0.62412615107
    0x00000000A01B1AD2LL,  // atan(0.72211350294) = 0.62541358615
    0x00000000A06F5250LL,  // atan(0.72407045010) = 0.62669863188
    0x00000000A0C361C1LL,  // atan(0.72602739726) = 0.62798129067
    0x00000000A1174932LL,  // atan(0.72798434442) = 0.62926156497
    0x00000000A16B08ABLL,  // atan(0.72994129159) = 0.63053945722
    0x00000000A1BEA038LL,  // atan(0.73189823875) = 0.63181496992
    0x00000000A2120FE4LL,  // atan(0.73385518591) = 0.63308810556
    0x00000000A26557BALL,  // atan(0.73581213307) = 0.63435886666
    0x00000000A2B877C3LL,  // atan(0.73776908023) = 0.63562725577
    0x00000000A30B700DLL,  // atan(0.73972602740) = 0.63689327545
    0x00000000A35E40A0LL,  // atan(0.74168297456) = 0.63815692830
    0x00000000A3B0E98ALL,  // atan(0.74363992172) = 0.63941821691
    0x00000000A4036AD4LL,  // atan(0.74559686888) = 0.64067714391
    0x00000000A455C48BLL,  // atan(0.74755381605) = 0.64193371196
    0x00000000A4A7F6B9LL,  // atan(0.74951076321) = 0.64318792371
    0x00000000A4FA016BLL,  // atan(0.75146771037) = 0.64443978186
    0x00000000A54BE4ACLL,  // atan(0.75342465753) = 0.64568928911
    0x00000000A59DA087LL,  // atan(0.75538160470) = 0.64693644818
    0x00000000A5EF3509LL,  // atan(0.75733855186) = 0.64818126183
    0x00000000A640A23DLL,  // atan(0.75929549902) = 0.64942373281
    0x00000000A691E830LL,  // atan(0.76125244618) = 0.65066386390
    0x00000000A6E306ECLL,  // atan(0.76320939335) = 0.65190165791
    0x00000000A733FE80LL,  // atan(0.76516634051) = 0.65313711766
    0x00000000A784CEF5LL,  // atan(0.76712328767) = 0.65437024597
    0x00000000A7D5785ALL,  // atan(0.76908023483) = 0.65560104571
    0x00000000A825FABALL,  // atan(0.77103718200) = 0.65682951974
    0x00000000A8765621LL,  // atan(0.77299412916) = 0.65805567095
    0x00000000A8C68A9DLL,  // atan(0.77495107632) = 0.65927950225
    0x00000000A9169839LL,  // atan(0.77690802348) = 0.66050101656
    0x00000000A9667F02LL,  // atan(0.77886497065) = 0.66172021682
    0x00000000A9B63F05LL,  // atan(0.78082191781) = 0.66293710598
    0x00000000AA05D84FLL,  // atan(0.78277886497) = 0.66415168702
    0x00000000AA554AECLL,  // atan(0.78473581213) = 0.66536396292
    0x00000000AAA496EALL,  // atan(0.78669275930) = 0.66657393668
    0x00000000AAF3BC55LL,  // atan(0.78864970646) = 0.66778161133
    0x00000000AB42BB3BLL,  // atan(0.79060665362) = 0.66898698990
    0x00000000AB9193A8LL,  // atan(0.79256360078) = 0.67019007544
    0x00000000ABE045A9LL,  // atan(0.79452054795) = 0.67139087100
    0x00000000AC2ED14DLL,  // atan(0.79647749511) = 0.67258937968
    0x00000000AC7D36A0LL,  // atan(0.79843444227) = 0.67378560456
    0x00000000ACCB75AFLL,  // atan(0.80039138943) = 0.67497954876
    0x00000000AD198E88LL,  // atan(0.80234833659) = 0.67617121538
    0x00000000AD678139LL,  // atan(0.80430528376) = 0.67736060758
    0x00000000ADB54DCELL,  // atan(0.80626223092) = 0.67854772850
    0x00000000AE02F456LL,  // atan(0.80821917808) = 0.67973258130
    0x00000000AE5074DELL,  // atan(0.81017612524) = 0.68091516916
    0x00000000AE9DCF74LL,  // atan(0.81213307241) = 0.68209549527
    0x00000000AEEB0426LL,  // atan(0.81409001957) = 0.68327356283
    0x00000000AF381301LL,  // atan(0.81604696673) = 0.68444937506
    0x00000000AF84FC14LL,  // atan(0.81800391389) = 0.68562293518
    0x00000000AFD1BF6BLL,  // atan(0.81996086106) = 0.68679424645
    0x00000000B01E5D16LL,  // atan(0.82191780822) = 0.68796331211
    0x00000000B06AD522LL,  // atan(0.82387475538) = 0.68913013542
    0x00000000B0B7279DLL,  // atan(0.82583170254) = 0.69029471966
    0x00000000B1035496LL,  // atan(0.82778864971) = 0.69145706813
    0x00000000B14F5C1ALL,  // atan(0.82974559687) = 0.69261718412
    0x00000000B19B3E38LL,  // atan(0.83170254403) = 0.69377507095
    0x00000000B1E6FAFELL,  // atan(0.83365949119) = 0.69493073193
    0x00000000B232927BLL,  // atan(0.83561643836) = 0.69608417040
    0x00000000B27E04BCLL,  // atan(0.83757338552) = 0.69723538972
    0x00000000B2C951D0LL,  // atan(0.83953033268) = 0.69838439322
    0x00000000B31479C7LL,  // atan(0.84148727984) = 0.69953118428
    0x00000000B35F7CADLL,  // atan(0.84344422701) = 0.70067576628
    0x00000000B3AA5A92LL,  // atan(0.84540117417) = 0.70181814259
    0x00000000B3F51384LL,  // atan(0.84735812133) = 0.70295831663
    0x00000000B43FA792LL,  // atan(0.84931506849) = 0.70409629179
    0x00000000B48A16CBLL,  // atan(0.85127201566) = 0.70523207149
    0x00000000B4D4613DLL,  // atan(0.85322896282) = 0.70636565915
    0x00000000B51E86F7LL,  // atan(0.85518590998) = 0.70749705822
    0x00000000B5688807LL,  // atan(0.85714285714) = 0.70862627213
    0x00000000B5B2647ELL,  // atan(0.85909980431) = 0.70975330433
    0x00000000B5FC1C69LL,  // atan(0.86105675147) = 0.71087815830
    0x00000000B645AFD7LL,  // atan(0.86301369863) = 0.71200083750
    0x00000000B68F1ED8LL,  // atan(0.86497064579) = 0.71312134540
    0x00000000B6D8697ALL,  // atan(0.86692759295) = 0.71423968550
    0x00000000B7218FCDLL,  // atan(0.86888454012) = 0.71535586129
    0x00000000B76A91DFLL,  // atan(0.87084148728) = 0.71646987628
    0x00000000B7B36FBFLL,  // atan(0.87279843444) = 0.71758173397
    0x00000000B7FC297DLL,  // atan(0.87475538160) = 0.71869143789
    0x00000000B844BF28LL,  // atan(0.87671232877) = 0.71979899157
    0x00000000B88D30CFLL,  // atan(0.87866927593) = 0.72090439853
    0x00000000B8D57E81LL,  // atan(0.88062622309) = 0.72200766232
    0x00000000B91DA84DLL,  // atan(0.88258317025) = 0.72310878648
    0x00000000B965AE43LL,  // atan(0.88454011742) = 0.72420777458
    0x00000000B9AD9072LL,  // atan(0.88649706458) = 0.72530463018
    0x00000000B9F54EE9LL,  // atan(0.88845401174) = 0.72639935684
    0x00000000BA3CE9B8LL,  // atan(0.89041095890) = 0.72749195815
    0x00000000BA8460EELL,  // atan(0.89236790607) = 0.72858243768
    0x00000000BACBB49ALL,  // atan(0.89432485323) = 0.72967079902
    0x00000000BB12E4CCLL,  // atan(0.89628180039) = 0.73075704577
    0x00000000BB59F194LL,  // atan(0.89823874755) = 0.73184118152
    0x00000000BBA0DB00LL,  // atan(0.90019569472) = 0.73292320989
    0x00000000BBE7A121LL,  // atan(0.90215264188) = 0.73400313449
    0x00000000BC2E4406LL,  // atan(0.90410958904) = 0.73508095894
    0x00000000BC74C3BELL,  // atan(0.90606653620) = 0.73615668685
    0x00000000BCBB2059LL,  // atan(0.90802348337) = 0.73723032186
    0x00000000BD0159E7LL,  // atan(0.90998043053) = 0.73830186760
    0x00000000BD477078LL,  // atan(0.91193737769) = 0.73937132771
    0x00000000BD8D641ALL,  // atan(0.91389432485) = 0.74043870584
    0x00000000BDD334DELL,  // atan(0.91585127202) = 0.74150400562
    0x00000000BE18E2D3LL,  // atan(0.91780821918) = 0.74256723073
    0x00000000BE5E6E09LL,  // atan(0.91976516634) = 0.74362838481
    0x00000000BEA3D68FLL,  // atan(0.92172211350) = 0.74468747152
    0x00000000BEE91C77LL,  // atan(0.92367906067) = 0.74574449454
    0x00000000BF2E3FCELL,  // atan(0.92563600783) = 0.74679945754
    0x00000000BF7340A6LL,  // atan(0.92759295499) = 0.74785236418
    0x00000000BFB81F0DLL,  // atan(0.92954990215) = 0.74890321816
    0x00000000BFFCDB14LL,  // atan(0.93150684932) = 0.74995202314
    0x00000000C04174CBLL,  // atan(0.93346379648) = 0.75099878282
    0x00000000C085EC41LL,  // atan(0.93542074364) = 0.75204350089
    0x00000000C0CA4186LL,  // atan(0.93737769080) = 0.75308618103
    0x00000000C10E74AALL,  // atan(0.93933463796) = 0.75412682696
    0x00000000C15285BELL,  // atan(0.94129158513) = 0.75516544236
    0x00000000C19674D0LL,  // atan(0.94324853229) = 0.75620203094
    0x00000000C1DA41F0LL,  // atan(0.94520547945) = 0.75723659641
    0x00000000C21DED30LL,  // atan(0.94716242661) = 0.75826914247
    0x00000000C261769ELL,  // atan(0.94911937378) = 0.75929967284
    0x00000000C2A4DE4BLL,  // atan(0.95107632094) = 0.76032819123
    0x00000000C2E82446LL,  // atan(0.95303326810) = 0.76135470136
    0x00000000C32B48A0LL,  // atan(0.95499021526) = 0.76237920694
    0x00000000C36E4B69LL,  // atan(0.95694716243) = 0.76340171170
    0x00000000C3B12CB0LL,  // atan(0.95890410959) = 0.76442221936
    0x00000000C3F3EC86LL,  // atan(0.96086105675) = 0.76544073365
    0x00000000C4368AFALL,  // atan(0.96281800391) = 0.76645725830
    0x00000000C479081CLL,  // atan(0.96477495108) = 0.76747179703
    0x00000000C4BB63FELL,  // atan(0.96673189824) = 0.76848435358
    0x00000000C4FD9EADLL,  // atan(0.96868884540) = 0.76949493168
    0x00000000C53FB83CLL,  // atan(0.97064579256) = 0.77050353506
    0x00000000C581B0B9LL,  // atan(0.97260273973) = 0.77151016747
    0x00000000C5C38835LL,  // atan(0.97455968689) = 0.77251483263
    0x00000000C6053EC0LL,  // atan(0.97651663405) = 0.77351753429
    0x00000000C646D46ALL,  // atan(0.97847358121) = 0.77451827619
    0x00000000C6884943LL,  // atan(0.98043052838) = 0.77551706207
    0x00000000C6C99D5ALL,  // atan(0.98238747554) = 0.77651389567
    0x00000000C70AD0C1LL,  // atan(0.98434442270) = 0.77750878074
    0x00000000C74BE387LL,  // atan(0.98630136986) = 0.77850172101
    0x00000000C78CD5BCLL,  // atan(0.98825831703) = 0.77949272024
    0x00000000C7CDA771LL,  // atan(0.99021526419) = 0.78048178216
    0x00000000C80E58B5LL,  // atan(0.99217221135) = 0.78146891053
    0x00000000C84EE999LL,  // atan(0.99412915851) = 0.78245410910
    0x00000000C88F5A2CLL,  // atan(0.99608610568) = 0.78343738160
    0x00000000C8CFAA7FLL,  // atan(0.99804305284) = 0.78441873178
    0x00000000C90FDAA2LL   // atan(1.00000000000) = 0.78539816340
};

// Fast lookup atan(x) with linear interpolation between table entries
// Input x is in fixed-point format with specified fraction bits representing a value in [-1,1]
// Output is in fixed-point format with the same fraction bits representing atan(x)
// Precision: ~1.5e-5 when fraction_bits=32
inline constexpr auto LookupAtanFast(int64_t x, int input_fraction_bits) noexcept -> int64_t {
    // Constants
    constexpr int kOutputFractionBits = 32;  // Internal calculation format
    constexpr int64_t kOne = 1LL << kOutputFractionBits;

    // Handle negative input
    bool is_negative = false;
    if (x < 0) {
        x = -x;
        is_negative = true;
    }

    // Convert input to internal format if needed
    if (input_fraction_bits != kOutputFractionBits) {
        if (input_fraction_bits < kOutputFractionBits) {
            x <<= (kOutputFractionBits - input_fraction_bits);
        } else {
            x >>= (input_fraction_bits - kOutputFractionBits);
        }
    }

    // 1. Ensure x is in [0,1] range
    if (x <= 0) {
        return 0;
    }
    bool use_reciprocal = false;
    if (x >= kOne) {
        // For x > 1, use atan(x) = π/2 - atan(1/x)
        use_reciprocal = true;
        // Calculate 1/x in fixed-point
        x = Primitives::Fixed64Div(kOne, x, kOutputFractionBits);
    }

    // 2. Scale x to table index
    const int64_t scale = static_cast<int64_t>(kAtanLut.size() - 1);
    const int64_t idx_scaled =
        Primitives::Fixed64Mul(x, scale << kOutputFractionBits, kOutputFractionBits);
    const int64_t idx = idx_scaled >> kOutputFractionBits;
    const int64_t t = idx_scaled & ((1LL << kOutputFractionBits) - 1);  // Fractional part [0,1)

    // 3. Clamp index to valid range
    if (idx >= static_cast<int64_t>(kAtanLut.size()) - 1) {
        // Return the maximum value (atan(1) = pi/4)
        int64_t result = kAtanLut[kAtanLut.size() - 1];
        if (input_fraction_bits != kOutputFractionBits) {
            if (input_fraction_bits < kOutputFractionBits) {
                result >>= (kOutputFractionBits - input_fraction_bits);
            } else {
                result <<= (input_fraction_bits - kOutputFractionBits);
            }
        }
        return is_negative ? -result : result;
    }

    // 4. Get table values for interpolation
    const int64_t y0 = kAtanLut[idx];
    const int64_t y1 = kAtanLut[idx + 1];

    // 5. Linear interpolation
    int64_t result = y0 + Primitives::Fixed64Mul(y1 - y0, t, kOutputFractionBits);

    // Apply reciprocal formula if needed
    if (use_reciprocal) {
        // π/2 in our fixed-point format
        constexpr int64_t kHalfPi = 0x00000001921FB544LL;  // pi/2 = 1.5707963267948966
        result = kHalfPi - result;
    }

    // 6. Convert result back to input format if needed
    if (input_fraction_bits != kOutputFractionBits) {
        if (input_fraction_bits < kOutputFractionBits) {
            result >>= (kOutputFractionBits - input_fraction_bits);
        } else {
            result <<= (input_fraction_bits - kOutputFractionBits);
        }
    }

    // Apply sign
    return is_negative ? -result : result;
}

}  // namespace math::fp::detail