#pragma once

#include <stdint.h>
#include <array>

// Atan lookup table with 256 entries
// Covers the range [0,1] with values scaled by 2^63
// Generated with mpmath library at 100 digits precision

namespace math::fp::detail {
// Table maps x âˆˆ [0,1] to atan(x)
// Values scaled by 2^63
constexpr std::array<int64_t, 257> AtanLUT = {
    0x0000000000000000LL,  // atan(0.0) = 0.0
    0x007fffd5556eeedcLL,  // atan(0.00390625) = 0.003906230131966971827628665311424387140357490115202856215213095149011344163954380208495709022456100032
    0x00fffeaaadddd4b9LL,  // atan(0.0078125) = 0.007812341060101111296463391842199281621222811725014723557453902248389872045335231379302642040135812015
    0x017ffb80184c309aLL,  // atan(0.01171875) = 0.01171821360239412863618316229152908705745345676652766964624816094197576224813102580250345591925541325
    0x01fff555bbb729abLL,  // atan(0.015625) = 0.0156237286204768308028015212565703189111141398009054178814105073966647741764017791232644450551360346
    0x027feb2be314dff6LL,  // atan(0.01953125) = 0.01952876704141370724753787341046141184235544088694651132327734728034302074775992676129860269329669544
    0x02ffdc03094b86b5LL,  // atan(0.0234375) = 0.02343320987946758445107229863741947545394174115884373522939008482649069244299089864088693220947855552
    0x037fc6dbe522e238LL,  // atan(0.02734375) = 0.02733693825782441190743189833607194312597257939332355371026660981022463756739506222460063319090804964
    0x03ffaab7752ec495LL,  // atan(0.03125) = 0.03123983343026827625371174489249097703249566372540004025531558625579642101943244717896297220075854501
    0x047f86970bb125d8LL,  // atan(0.03515625) = 0.03514177680279678266925872642407145125046234162092682363925321213254295471711912158869896387685851282
    0x04ff597c5a727645LL,  // atan(0.0390625) = 0.03904264995516699345275445132693162747221356328128673424787050313158380691691707534286136600539838392
    0x057f22697e8ecb52LL,  // atan(0.04296875) = 0.04294233466236217275837618398091923343024820231576373309000986425864926277456168138857884459526094711
    0x05fee0610c368a7eLL,  // atan(0.046875) = 0.0468407129159696537522237600018573448670521919549065068342937213124999631259515812246655692674222898
    0x067e92661a6137d3LL,  // atan(0.05078125) = 0.05073766694546021984574714406291167925745268555331170524577309281904103056796743338652987246056371861
    0x06fe377c4e7110e7LL,  // atan(0.0546875) = 0.05463307923935947507138879374732662585598859692564601507854566343068953702940935976689869095710496569
    0x077dcea7e7c6207dLL,  // atan(0.05859375) = 0.05852683256630176997379022550417838224049255922002084637673698344763689576228477770696231231128419246
    0x07fd56edcb3f7a71LL,  // atan(0.0625) = 0.06241880999595734847397911298550511360627388779749919460752781689869026721680345781396936172340611606
    0x087ccf538ea9537bLL,  // atan(0.06640625) = 0.06630889491982348789002609340337138255112901542598420403520311766023574611311456549048257981073056683
    0x08fc36df8416ac6fLL,  // atan(0.0703125) = 0.07019697107187051852187630470349658568047613221713327669533148058959529031857027050019123395205793335
    0x097b8c98c5254d01LL,  // atan(0.07421875) = 0.07408292254903373077690284326396102238771428225435739469555332926652783839643277368560597631678983234
    0x09facf873e2aceb5LL,  // atan(0.078125) = 0.07796663383154230656332864878102746090632470867886245901563369876547822084308667763958369798573662969
    0x0a79feb3b9497d90LL,  // atan(0.08203125) = 0.08184798980307654743911654486417946087087309460345270798083390749790856398940862526112682140715060579
    0x0af91927e96bd931LL,  // atan(0.0859375) = 0.08572687577074481459363165573197294311643892961152332547541948335637444044725558049785708204041053878
    0x0b781dee75258676LL,  // atan(0.08984375) = 0.08960317748487174496938422265339464981975703080877995714082502354668857712031309007768668213268857752
    0x0bf70c1301788746LL,  // atan(0.09375) = 0.09347678115858946350452719331206047882316494677436346307898729543199662804760028820206365622953648715
    0x0c75e2a23c7d9417LL,  // atan(0.09765625) = 0.09734757348722367338896828792992000890515689598816392666009207956738544990224103499643698318492658848
    0x0cf4a0a9e7ee78b4LL,  // atan(0.1015625) = 0.1012154416674666741662006965791130933351815782644886322207818709945478972153117609218112803679957903
    0x0d734538e3915c1cLL,  // atan(0.10546875) = 0.1050802734163295312606859592204016320108881460692260994428161739616906454249214296708840816953346604
    0x0df1cf5f3783e1beLL,  // atan(0.109375) = 0.1089419569898657998418608611626007547402118966352416678204669020486025144711363749374530289096069092
    0x0e703e2e1e651911LL,  // atan(0.11328125) = 0.1128003812016593906196311931548322366357765742962438609312099334319473773244601474813726924837883095
    0x0eee90b80f5d3732LL,  // atan(0.1171875) = 0.1166554354410693549660528495092536213281020086026085336617319649073516518155146426812679595300021122
    0x0f6cc610c8021d7bLL,  // atan(0.12109375) = 0.1205070096912245614321661869604250914028875926827769644895943344182806264871982712521783033802578438
    0x0feadd4d5617b6e3LL,  // atan(0.125) = 0.1243549945467614350313548491638710255731701917698040899151141191157222674275667586237105943133533303
    0x1068d584212b3d98LL,  // atan(0.12890625) = 0.1281992812312981343406366401487441634098976619617240145858303533553645650728631160857101567543811609
    0x10e6adccf408818aLL,  // atan(0.1328125) = 0.1320397616146387492746844065265695273028022413111516111565143556404418490190855441245320293696721176
    0x116465410608505aLL,  // atan(0.13671875) = 0.1358763282297013140565290035557399655190069681632550771294518362016126114798597195535909070791725432
    0x11e1fafb043726e4LL,  // atan(0.140625) = 0.1397088742891636451833677767390950657688448652604789018679543602196417770510611101665125771623588157
    0x125f6e171a535c5fLL,  // atan(0.14453125) = 0.1435372937018212328028454120253374836894062487978296360968593334450794947340342589260213656372260211
    0x12dcbdb2fba1ff31LL,  // atan(0.1484375) = 0.1473614810886516356098027603968455300910930246748941178703647099233001944131719396905017405258382473
    0x1359e8edeb99a396LL,  // atan(0.15234375) = 0.1511813317985800538795306620047925805779275576297377999358150059361854527052754442998463199097138191
    0x13d6eee8c6626c58LL,  // atan(0.15625) = 0.1549967419239409823037143749334921910556061206490869253147273999152294773806950197008564306357667106
    0x1453cec6092a9e47LL,  // atan(0.16015625) = 0.1588076083156310736216211412495308911327724066485050171217221500284004021356753711293731837070960798
    0x14d087a9da4f1747LL,  // atan(0.1640625) = 0.1626138285979485753736415637615578020999123367922946323815024360453533967251216977392249989375042677
    0x154d18ba11570a46LL,  // atan(0.16796875) = 0.1664153011831149351793188330008522128921400670266405560340977637119134914798354072174646848202367542
    0x15c9811e3ec269dfLL,  // atan(0.171875) = 0.1702119252854744044904966070997617094784754749060013686882388147708062450574576947412727783473133003
    0x1645bfffb3aa73f0LL,  // atan(0.17578125) = 0.1740036009353677065263544909191767769415808485661890189300638784439237647795024116610441253267484018
    0x16c1d4898933d8daLL,  // atan(0.1796875) = 0.1777902289926760707966247992158246962376863486968056255240827915463868112278893030720836879190107372
    0x173dbde8a7d201d4LL,  // atan(0.18359375) = 0.1815717111600321739999264179127003307740681066485523566655580614670958811934639222067226029862416523
    0x17b97b4bce5b0226LL,  // atan(0.1875) = 0.1853479499956947648860259612285446445152664387105691933719293831307993657695136657423320599637130403
    0x18350be398ebc7d4LL,  // atan(0.19140625) = 0.1891188489260839886368298551169047995705515938048451681781759552068992683149052603138637187826820787
    0x18b06ee2879c28bbLL,  // atan(0.1953125) = 0.1928843122579746641970587106902272935472056746803236074880621771507960816283508052890919210347273488
    0x192ba37d050271bcLL,  // atan(0.19921875) = 0.1966442451903450055214056097745109154248355037549745351584118075390854285628081732987756901043906803
    0x19a6a8e96c86261cLL,  // atan(0.203125) = 0.2003985538258785146539457850343783805549732856030671551768537608513736941861984861811174732527142475
    0x1a217e601081a5bcLL,  // atan(0.20703125) = 0.2041471451821170106752632263240606531619549313603159799076325435630887289505259052140642049748870052
    0x1a9c231b40327943LL,  // atan(0.2109375) = 0.207889927202262993605334983102994330282319096921861985705480102456927064403339413601080001186306123
    0x1b1696574d780bcfLL,  // atan(0.21484375) = 0.2116268087656297761026504298655588365874101610959091711628645984310895575026720429718666289387606406
    0x1b90d7529260a204LL,  // atan(0.21875) = 0.2153576996977380480244596271664896504990190531930730185582711923130547956491979608839763081971728273
    0x1c0ae54d768466beLL,  // atan(0.22265625) = 0.2190825107800577693869771827013752101650685643193026679791251437286429497618270731492394359857639974
    0x1c84bf8a742e6dcdLL,  // atan(0.2265625) = 0.2228011537593945157710321221404325470734672705161630412994447947118061551779154147697622576181333263
    0x1cfe654e1d539551LL,  // atan(0.23046875) = 0.2265135413569196265471977704743161470936096693699234019504417030066533312422871639667910455176241755
    0x1d77d5df20573671LL,  // atan(0.234375) = 0.2302195872768437302401709596798029893210973524707267782665621076760310664615144235655932039086553943
    0x1df110864c9d9df5LL,  // atan(0.23828125) = 0.2339192062147334427167919233326140721707758507564418180896849790298661333690413816618205766159271647
    0x1e6a148e96ec4d61LL,  // atan(0.2421875) = 0.2376123138654712524738836343256377747061844711905254332532131536372090447269766971890430638580827331
    0x1ee2e1451d980cccLL,  // atan(0.24609375) = 0.2412988269308588229360892277580776203881456160849463799307028068161959254553483219154099088225427614
    0x1f5b75f92c80dd62LL,  // atan(0.25) = 0.2449786631268641541720824812112758109141440983811840671273759146673551195876420965745341576687019914
    0x1fd3d1fc40dbe413LL,  // atan(0.25390625) = 0.2486517411905132556289916349649685377410550413470393732248509015682743316939174394186636315648263745
    0x204bf4a20ccb6b4cLL,  // atan(0.2578125) = 0.2523179808864271872059075075476730799702476596392323763333796743013654179428837106973283079172074422
    0x20c3dd407ac521eaLL,  // atan(0.26171875) = 0.2559773030130055280815819531263685250424473877281210027490530280337271089442939091605067913258188758
    0x213b8b2fb0c6c4b1LL,  // atan(0.265625) = 0.2596296294082575310299464431839718889129771614199468015618374248297152887890684677498211292323400993
    0x21b2fdca135966a3LL,  // atan(0.26953125) = 0.263274882955282414358508647782094893358885737921578858614056152030810268945187055461365143699257375
    0x222a346c48639359LL,  // atan(0.2734375) = 0.2669129875874004339552348564915996733623482913549089537304209285065830217736668116793766836323869496
    0x22a12e7539ca8d43LL,  // atan(0.27734375) = 0.2705438682929365641030717758984053588728095824296071563990270975926780034058825474618286255684607711
    0x2317eb4617e2f04cLL,  // atan(0.28125) = 0.2741674511196587975993718983421758015541963009643242258231160849304350877964122335145720927192274272
    0x238e6a425bb107a0LL,  // atan(0.28515625) = 0.2777836631788732531894506483442895038134667011276264785305531022607917852360116567153736991161339405
    0x2404aacfc8f92bb9LL,  // atan(0.2890625) = 0.2813924326491784512863373252052941836192277425714070109093745200926064638937555656854016719598029185
    0x247aac56702083c7LL,  // atan(0.29296875) = 0.2849936887798812873072243051277165592403618315823593779128511103345325679837313729137297721955214746
    0x24f06e40afde8b7cLL,  // atan(0.296875) = 0.2885873618940773956236114199582183226534841537821243077596070316459730635816619632922454607490469103
    0x2565effb36bfc405LL,  // atan(0.30078125) = 0.2921733833913987560167951968726367411638486777293734471246323328583690723926968189718799862602562777
    0x25db30f50479fc6eLL,  // atan(0.3046875) = 0.2957516857504315485808979994626896776271120135318894950138505535828571429187180924057030422385525306
    0x2650309f6b12a32bLL,  // atan(0.30859375) = 0.2993222025308074121573644515551242327077140637521672503803547871302792359316119654521864334895229974
    0x26c4ee6e0fd7979aLL,  // atan(0.3125) = 0.302884868374971405560556094505558213291539411316998600399325053204421200741943415905647619100898225
    0x273969d6ec2af768LL,  // atan(0.31640625) = 0.3064396190096301100139399123201573764815699729943145719758064075416139805845799116371502048645233607
    0x27ada2524e226889LL,  // atan(0.3203125) = 0.3099863912468834453178920488852007919328639182779188890516910136554239187057916312385441770431439016
    0x2821975ad8fa6527LL,  // atan(0.32421875) = 0.3135251229850439012780280901117115921113270768130725928345825898800447620536469183750977341979191632
    0x2895486d855e1351LL,  // atan(0.328125) = 0.3170557532091470098090155766744673154223474622686501602026135182170355280099695928777028535601496318
    0x2908b509a184368fLL,  // atan(0.33203125) = 0.320578221991157001871772602948911695065667912771478724095011559029748642351563503829796294182423023
    0x297bdcb0d121cd86LL,  // atan(0.3359375) = 0.3240924704898717069873818070036072212289565989016489497982513532138821598728379554671757481152882156
    0x29eebee70d32f1cdLL,  // atan(0.33984375) = 0.3275984409505308614912040439765353192600287586394664521518809954892118979832987264421414667979249423
    0x2a615b32a39a93b6LL,  // atan(0.34375) = 0.3310960767041320949443387877569445454685703245962400627971478610779833299082354991634841107287428772
    0x2ad3b11c3699af80LL,  // atan(0.34765625) = 0.3345853221664589622118924171278064328685318215194403899409230291621211014359417744561631589019552779
    0x2b45c02ebc1e9c89LL,  // atan(0.3515625) = 0.3380661228368254816598223422680471566460376430738927659511557739471042307391207564349918915263465228
    0x2bb787f77ced1a7aLL,  // atan(0.35546875) = 0.3415384252965417277317893663729817616564109996538910634920960384795709826112856009708813809564702358
    0x2c290806139fc32cLL,  // atan(0.359375) = 0.3450021772071051088676812869000516900113601972942199380727074600044602728256845248871036986150949642
    0x2c9a3fec6b838b02LL,  // atan(0.36328125) = 0.3484573273081220393451342288521158295214274742445996192037521135390357974626468988869780347910379112
    0x2d0b2f3ebf4dfbedLL,  // atan(0.3671875) = 0.3519038254149647861988092323316355118600141577780769825749195563234777510908145425819202928154217558
    0x2d7bd59397aed9cbLL,  // atan(0.37109375) = 0.3553416224161683399389883226315691738534068508280064157078425989342870479806888708162160534852118784
    0x2dec3283c9bde11cLL,  // atan(0.375) = 0.3587706702705722203959200639264604997769756558809157796403988667547031842211293287432644092694253731
    0x2e5c45aa75455313LL,  // atan(0.37890625) = 0.3621909220042121867088266710704666583017364432308553187711564588221389999532926827916901675989479643
    0x2ecc0ea502ea03e2LL,  // atan(0.3828125) = 0.3656023317069668733128101132586805962551180049925640443396377102189879717477174345253577210240506524
    0x2f3b8d132231a206LL,  // atan(0.38671875) = 0.369004854528964421811753761974130858692235271957958031978009760810959432677646991164672589828978692
    0x2faac096c767eeb4LL,  // atan(0.390625) = 0.372398446676754221923655038283701832488716213956580184044657821464247567091453398487097652455832937
    0x3019a8d42963a10cLL,  // atan(0.39453125) = 0.3757830654092489133136356474707120104766352735680184317351309234671078613633624516381765140183276114
    0x30884571bf2baeebLL,  // atan(0.3984375) = 0.3791586690334418341599883683469451773482195089855822518252507481072498313277975847644801073837580707
    0x30f696183d7db749LL,  // atan(0.40234375) = 0.3825252168999051318044884559523289405921623070867407970980148684845304172513717637342892223738738892
    0x31649a7294364adbLL,  // atan(0.40625) = 0.3858826693980737758976954846072314117540442397582440755854212130993033910293976651842219529350915212
    0x31d2522deb9bd0a6LL,  // atan(0.41015625) = 0.389230987951320735144177010449927508752719117717332144169572947676466527474465141536706119328118526
    0x323fbcf9a18cc488LL,  // atan(0.4140625) = 0.392570135011828595165576659715816378558832667534965738606051179137490627266936501229114555736043194
    0x32acda8746920e66LL,  // atan(0.41796875) = 0.3959000740552629072180958561072232799966307257325001122250322718006244324550531614614052572717195037
    0x3319aa8a9ad630cfLL,  // atan(0.421875) = 0.3992207695752525656147166961588647858871046634029382873771130328989274122156145452059568415849844744
    0x33862cb98b020e1bLL,  // atan(0.42578125) = 0.4025321870776825158032032803259728288127629896999169829541546041086956880886793596142509130266728158
    0x33f260cc2d00031bLL,  // atan(0.4296875) = 0.4058342930748040952326027825138523405910269253116482244470746578080838922636395219743098764112202971
    0x345e467cbca61630LL,  // atan(0.43359375) = 0.4091270550791683054996333411334889838629824895379438022557361806145983759059440359092083862730955236
    0x34c9dd879847f96dLL,  // atan(0.4375) = 0.4124104415973873068997912896671269370468081918742117396497230596647925000486607874371781566764226263
    0x353525ab3d319e12LL,  // atan(0.44140625) = 0.4156844221237294155156318130122540489799513011499603162677465637582170623350444148143353277559532966
    0x35a01ea8440b16feLL,  // atan(0.4453125) = 0.4189489671335528684572821440930714724074589878422773363909164973697858449585377946064648137437149147
    0x360ac8415d268736LL,  // atan(0.44921875) = 0.4222040480765836049298690477153089839873034232097074689511468229908344177966685997215207128875573372
    0x3675223b4cb8d8d7LL,  // atan(0.453125) = 0.4254496373700422895422636051807923498355341597085065511494519815299457030954970362366966954591350223
    0x36df2c5ce6fdf7c6LL,  // atan(0.45703125) = 0.4286857083916257797953184816987778679689550472310136210808527072293831853334996476939575767915709054
    0x3748e66f0c494aa8LL,  // atan(0.4609375) = 0.43191223547234821210024826236796224874673764396455856624708691495424403735380915170555460197176624
    0x37b2503ca503235aLL,  // atan(0.46484375) = 0.4351291938892468500841679534844144634260127269072128554823686517393293166525645129807603058580676269
    0x381b69929d93df19LL,  // atan(0.46875) = 0.4383365598579578054456160492147713300291342094359266540263193467257348509366665746987998365355658067
    0x3884323fe23d6d27LL,  // atan(0.47265625) = 0.4415343105251667053339193697444980856882950998313144760000301984612366722237758682298445588894011766
    0x38ecaa155ae3f145LL,  // atan(0.4765625) = 0.4447224239609393412483431930515242815743896330744725118621259964703556419875545744401316764531628012
    0x3954d0e5e6c63606LL,  // atan(0.48046875) = 0.447900879150937292891864766948563518939124546079944770769205515134059691950278743907112595345001751
    0x39bca6865826a12eLL,  // atan(0.484375) = 0.4510696559885234763756392572821934177106265424977226461692578892296239920562274968807082834872199643
    0x3a242acd6fe55adfLL,  // atan(0.48828125) = 0.4542287352667625197589621479305591729010429092604316483811191958828600637920083213869418053766842868
    0x3a8b5d93d90c5662LL,  // atan(0.4921875) = 0.4573780986703208202304474687766769716587308610636639783248292304442556826049989613899435538756124699
    0x3af23eb4244de9afLL,  // atan(0.49609375) = 0.4605177287672710863932970462960607207188603078751550642252658110136506477944477546397715386603445571
    0x3b58ce0ac3769ed1LL,  // atan(0.5) = 0.4636476090008061162142562314612144020285370542861202638109330887201978641657417053006002839848878926
    0x3bbf0b7604d2e850LL,  // atan(0.50390625) = 0.4667677236808665063346099251426359649405365921894519957971997929291770506411412087255910615974053565
    0x3c24f6d60e895fdaLL,  // atan(0.5078125) = 0.4698780579756869317238837674289664081621147730231348279723686024859197818005067503181736464877604945
    0x3c8a900cd9ea3413LL,  // atan(0.51171875) = 0.4729785979032655761832312720130461133865201491153663203038656555645773632717395809292599778573924687
    0x3cefd6fe2eb46887LL,  // atan(0.515625) = 0.4760693303227612340751004202614715119088464976222847103432589737160750943506023978501728456935621139
    0x3d54cb8f9e51884bLL,  // atan(0.51953125) = 0.4791502429258225419667220630355108222680744078740661051436618971870254337518141313365977307730725682
    0x3db96da87f0869c0LL,  // atan(0.5234375) = 0.4822213242278537357239469689630996105611193165401858618231765155976201464049096817390585314932064779
    0x3e1dbd31e7279f68LL,  // atan(0.52734375) = 0.485282563559221264074256608867098563554094395294159751062096371676057675388356132575640060604833735
    0x3e81ba16a8282f97LL,  // atan(0.53125) = 0.4883339510564055238671649607470648373584289235516097057105384310258923841457578095036982538639548513
    0x3ee5644349c92a29LL,  // atan(0.53515625) = 0.4913754776531019152889257501002322926417075047104147895088308106755272735403029805222558048291553952
    0x3f48bba60524b11aLL,  // atan(0.5390625) = 0.4944071350712753472270372523319383605721614879309473474832214172173888875995644984791047547693108422
    0x3fabc02ebfbf064eLL,  // atan(0.54296875) = 0.4974289158121722539173742536110067127379275033047657046445192698870003633824051996799193778266098232
    0x400e71cf06902e4cLL,  // atan(0.546875) = 0.5004408131472941140300005149792245065381292042708689001120524858527238141618277793994398605337587786
    0x4070d07a0908b53dLL,  // atan(0.55078125) = 0.5034428211093363925441476327936602337980464744041220957936385168186105110053078775944141526225978779
    0x40d2dc24941220c7LL,  // atan(0.5546875) = 0.506434934483096754211959446747458560803899780779583284450624745233069126518837107578434354762763739
    0x413494c50d0b96e3LL,  // atan(0.55859375) = 0.5094171487963563251959744277409747631300702228553302869740830007524639990180698971426023245231269537
    0x4195fa536cc33f15LL,  // atan(0.5625) = 0.5123894603107377066666010205842592544212320626687267546687263771324272060000640393911197876143411384
    0x41f70cc93a6ce0dbLL,  // atan(0.56640625) = 0.5153518660125433708407187982195112412048458643540644468612326936020228280536991747482249791750592772
    0x4257cc2186963f76LL,  // atan(0.5703125) = 0.5183043636035779962067055995151580099998839241769934466088948148935214138846132269713463761482030866
    0x42b83858e619b083LL,  // atan(0.57421875) = 0.5212469514919582245883250019548067267644440451223318034000817167763568628120032984048767217786762178
    0x4318516d6d0f6832LL,  // atan(0.578125) = 0.5241796287829132483216496175045301573782013874844117126641819717258393854846961662579145993964792986
    0x4378175ea9bdf33eLL,  // atan(0.58203125) = 0.527102395269579561225129757311921621675908968616588030716458577570960632805902754197431221596553581
    0x43d78a2d9f8a5400LL,  // atan(0.5859375) = 0.5300152514237931323005627690087055918847757417538726124455447141312968852416876002096306586546547323
    0x4436a9dcc1e83569LL,  // atan(0.58984375) = 0.5329181983868821862775179633192198840775119323665812282564951640882573030512686393035303258075387644
    0x4495766fef4aa3daLL,  // atan(0.59375) = 0.5358112379604637002690850687076914070989005245394483123406227943686293818025137517350378137778115
    0x44f3efec6c15b931LL,  // atan(0.59765625) = 0.5386943725972466510039148974642466203683398369608157445364215505196313983560854916996264021423306051
    0x45521658dd91a6b4LL,  // atan(0.6015625) = 0.5415676053918449723975989999416057929878902509651592073500456002379649444999487710520343634601604994
    0x45afe9bd44df84cbLL,  // atan(0.60546875) = 0.5444309400716031086825990730769215588418458440309530490801995558572808795687397653073992149612783185
    0x460d6a22f9f04dc6LL,  // atan(0.609375) = 0.5472843809874369739852207703127568758089721415103013473540911426263526762949804146584198316862659575
    0x466a9794a67e6659LL,  // atan(0.61328125) = 0.5501279331046930551734990823658377065368521759645958014645710078282329295688419986030715783204643423
    0x46c7721e410a13b7LL,  // atan(0.6171875) = 0.5529616019940283210522390754781720159727821425290639672558339019348978606206785605539614504052298318
    0x4723f9cd07d93c94LL,  // atan(0.62109375) = 0.555785393822313527599713099567166874146084160449467187213177954219140725767539759654075802578354246
    0x47802eaf7bfacfcdLL,  // atan(0.625) = 0.5585993153435624359715082164016612703464475825340148061336360381417482360269765762752961879315300671
    0x47dc10d55c4e28b6LL,  // atan(0.62890625) = 0.5614033738898893874855972097983260121200130722458116476645211504983840902315848044117375072419603285
    0x4837a04fa08ec686LL,  // atan(0.6328125) = 0.5641975773624976077917430252672946629224271029721938672656673342183329201832682306932360078921983203
    0x4892dd307464a9d6LL,  // atan(0.63671875) = 0.5669819342227005409587511404179037954205396628497590475741048861149667892117202786944822913507014567
    0x48edc78b3279a871LL,  // atan(0.640625) = 0.5697564534829784433238348916655609510164382145876164897112097886766975133067370376297818727299373763
    0x49485f745f940556LL,  // atan(0.64453125) = 0.5725211446980723966765260267316798238160343400428539501255252102892549842730598439629181377141686521
    0x49a2a501a5b6983aLL,  // atan(0.6484375) = 0.5752760179561178307303390604991627189109174193112397051634447746896464439472523795243084334661022071
    0x49fc9849cf46cd43LL,  // atan(0.65234375) = 0.5780210838698195759021270589513997742864022531545992118630804655123945600793666016585423312368690126
    0x4a563964c238c37bLL,  // atan(0.65625) = 0.5807563535676703992032744750015008620986412658876729497657303059024187575485824261920377935165627472
    0x4aaf886b7b41cdc2LL,  // atan(0.66015625) = 0.583481838685214908578300827314432316224370399954933475067756271752048759212346876538441061813125617
    0x4b088578091197ebLL,  // atan(0.6640625) = 0.5861975513563606443330871822473274046392978581169379868872716182962213404007674447298737837969940193
    0x4b6130a587922f06LL,  // atan(0.66796875) = 0.5889035042047381104030586751240156526947573962169200593550806733266940295738240127378335259611629492
    0x4bb98a101b2f29c5LL,  // atan(0.671875) = 0.5915997103351114331458526589590323175428749142126929968862942385733114894943149329500429790130263365
    0x4c1191d4ec242b60LL,  // atan(0.67578125) = 0.5942861833248412711262207563990554236516089977943993000321608365851092946306743220644047064437376415
    0x4c69481221d2f940LL,  // atan(0.6796875) = 0.5969629372154015360144938318679089098453376120746064203213798428814894677275783285432490813955909456
    0x4cc0ace6de21595dLL,  // atan(0.68359375) = 0.599629986503951422263651682856400809269394309163385385775350280953046803443633371043621066746393254
    0x4d17c07338deed10LL,  // atan(0.6875) = 0.6022873461349641816821226942042329099994717399735277191851194659937876137207929330308430882769443759
    0x4d6e82d83b3339e3LL,  // atan(0.69140625) = 0.604935031491914018396638896974462074326441618330825272077548191475319629942206170080870802389667574
    0x4dc4f437db140fd6LL,  // atan(0.6953125) = 0.6075730583890224200170815974795400481266678290895608217336904325736383823371416818886099681709069839
    0x4e1b14b4f6c47a48LL,  // atan(0.69921875) = 0.6102014430630651820871509675178297209907458594859954532066216033072895556222215480274975404185038222
    0x4e70e473505c66dcLL,  // atan(0.703125) = 0.61282020216524132514338463549568916572559429115248692477036611732353938470140492891308620626921661
    0x4ec6639789592b68LL,  // atan(0.70703125) = 0.6154293527531050469217061540627728568485106965669010957449347901831686262342088260816580029518828164
    0x4f1b92471e37121eLL,  // atan(0.7109375) = 0.6180289122825617964551808283642598385877080163498262411554303856127819828222971491527190177269777543
    0x4f7070a86214112cLL,  // atan(0.71484375) = 0.6206188985999295020076161695170168216470368763921852076207810482022515820696453731433783953343250546
    0x4fc4fee27a5bd0f6LL,  // atan(0.71875) = 0.6231993299340659309924753490603745950873884156818533982314120078497864886301373453894948404711895458
    0x50193d1d5a7d2255LL,  // atan(0.72265625) = 0.625770224888563107241508225552980545699689110908725886302682009179758632924580733736015978984066817
    0x506d2b81bfa9044fLL,  // atan(0.7265625) = 0.6283316024340096592176448127738759960600873148387101633099875825577120940118276128598304737527301323
    0x50c0ca392c9b56ecLL,  // atan(0.73046875) = 0.6308834819003219220160441936770348306501242441137241451767304378316997114407254711866302281857238554
    0x5114196de56d5704LL,  // atan(0.734375) = 0.6334258829691445662686954830592997672811323516074966792722123312475593633595716991186285739990744717
    0x5167194aeb71fd19LL,  // atan(0.73828125) = 0.63595882566632147836355688738422851697984846466993607345681021767235552644626877410607684296712252
    0x51b9c9fbf91c57b1LL,  // atan(0.7421875) = 0.638482330354437568709845837024868014878350594402228933757098043006217355940995209208866407665321744
    0x520c2bad7deff7cbLL,  // atan(0.74609375) = 0.6409964177254321381267685531137761829210395917227949988821672517165873112121188340954236837548095613
    0x525e3e8c9a7b8492LL,  // atan(0.75) = 0.6435011087932843868028092287173226380415105911153123828656061187135124748116210887128168447012827489
    0x52b002c71c5d89b2LL,  // atan(0.75390625) = 0.6459964248867716056649293813883652506305444451446144161690228593566884970943796724857194683802947693
    0x5301788b7a53923fLL,  // atan(0.7578125) = 0.6484823876423005464090698119162580842323051110966294459292938642654933873489081964862006390670409707
    0x5352a008d053a078LL,  // atan(0.76171875) = 0.6509590189968124238718208417639584588624743142790186893066925182423333655372610092481951699748353296
    0x53a3796edbb0114aLL,  // atan(0.765625) = 0.6534263411807619628638934113116296719751614612726223247134373912574567828949985942954568154701030938
    0x53f404edf745f8eaLL,  // atan(0.76953125) = 0.6558843767111708610342239012183110274034441869712796613866697241758416655226666974867721135875145015
    0x544442b717b60491LL,  // atan(0.7734375) = 0.6583331483847559997836305857185611307126149441655142736094589872150143840407716732365075759298377576
    0x549432fbc7a7ebd5LL,  // atan(0.77734375) = 0.6607726792711326966927061982515851196483840078175827965275402847978822222714257516445236756444233045
    0x54e3d5ee24187ae4LL,  // atan(0.78125) = 0.6632029927060932553632543102382758732632560471157320053921438799759137519871205666808167459527566351
    0x55332bc0d8b23d8aLL,  // atan(0.78515625) = 0.6656241122849610319886429029299603188075735483970265909030277769556993886803681503775267052932159331
    0x558234a71c30d199LL,  // atan(0.7890625) = 0.6680360618560202023579847712093188934588662459146446904670338346840676559325712626849765992573306279
    0x55d0f0d4accee615LL,  // atan(0.79296875) = 0.6704388655140213783535625858059100689744643789626468534452486016486915226811481169955539182933696186
    0x561f607dccbeeb50LL,  // atan(0.796875) = 0.672832547593763189311401329261527736114442359864269005158930934214550069696741413872952263650733738
    0x566d83d73eae76e4LL,  // atan(0.80078125) = 0.675217132663749910871890074572198440528064337962960346504023144658528927399942694347130147553396389
    0x56bb5b1642545d73LL,  // atan(0.8046875) = 0.6775926455199251921409679777758410904743252380440809458302241911542162654581367353375410870956885258
    0x5708e670910982ceLL,  // atan(0.80859375) = 0.6799591111794819011023047982900000015662511832567451787209936667580343920326178218592785557955945798
    0x5756261c5a6c6040LL,  // atan(0.8125) = 0.6823165548747480782564299817111529931429300101910564604944902627730406087438413140266664103010737937
    0x57a31a50410f3f7aLL,  // atan(0.81640625) = 0.6846650020471489594028454128556358493588231666276278671292846236939816421230219347980177386055476678
    0x57efc343573127c9LL,  // atan(0.8203125) = 0.6870044783412450003144135183116685785917418971423625639382640827405120768428025697848251784738436877
    0x583c212d1b817a24LL,  // atan(0.82421875) = 0.6893350095988458087680566710138536846492318862152682184479954341742267719479898185190529747318395096
    0x5888344575ee37b5LL,  // atan(0.828125) = 0.69165662185319986298006631811035296835312346875326923979210445210701083225187296137354207818839048
    0x58d3fcc4b47ced9dLL,  // atan(0.83203125) = 0.6939693413232598699358731861827298287250810198401299288550312893105132966204937263632791819417773386
    0x591f7ae3882e3fc2LL,  // atan(0.8359375) = 0.6962731944080235923905100965443800214206396139901212183141660287756729604534102416563443279896564919
    0x596aaedb01ec0ba1LL,  // atan(0.83984375) = 0.6985682076809499494345296402629417634283673850971265291400699476522250871436363500313908462019589071
    0x59b598e48f821b48LL,  // atan(0.84375) = 0.7008544078844501724579512817867512680901404126357775508086451618051429830632865008273106510311077661
    0x5a003939f8a15fceLL,  // atan(0.84765625) = 0.7031318219244537760888657487000538044403882507859272566210526502500682286297495195450189424062716999
    0x5a4a90155beda9d9LL,  // atan(0.8515625) = 0.7054004768650490822204263019559126349161718549069636897279047455757295999063464312978402390837052785
    0x5a949db12c15d609LL,  // atan(0.85546875) = 0.7076603999231980145567813502053069830927015230014093538881148495030363354705412208216026411391051164
    0x5ade62482cf66257LL,  // atan(0.859375) = 0.7099116184635248611916111509362458563819539993569347068261099843450448211474840458909808779004454257
    0x5b27de1570c660e0LL,  // atan(0.86328125) = 0.7121541599931786835687865912615918621031431867975561293154003662095884525498590446341913381453845965
    0x5b711154554ebbc8LL,  // atan(0.8671875) = 0.7143880521567690317496541110864489285948673346477230839399248989537253661264087456951539739401273877
    0x5bb9fc40812bbd69LL,  // atan(0.87109375) = 0.7166133227313746082118881845094079714485965679886832159959940679654508351224601737906863901863090884
    0x5c029f15e118cf39LL,  // atan(0.875) = 0.7188299996216245054170141515259046539514191200183170855427796828611200091030244602752510405501618942
    0x5c4afa10a546615cLL,  // atan(0.87890625) = 0.7210381108548516260938296152692867128631135632718432041706509183620982473400543121759458120751368845
    0x5c930d6d3eb9ec32LL,  // atan(0.8828125) = 0.7232376845763178795792637634429094912167873863318351586711291725770890445391867627756060560435992576
    0x5cdad9685cb7fcbbLL,  // atan(0.88671875) = 0.7254287490445107326229278945065020673688117465810783749688198749708859952806901176262578216976297307
    0x5d225e3eea383c17LL,  // atan(0.890625) = 0.7276113326265106787829526909499757625739953878994317350295784941770659266125132804150557778075433094
    0x5d699c2e0b6361eeLL,  // atan(0.89453125) = 0.7297854637934291769049249618444641766731469344433207460432489729809092456534855191849137264466766195
    0x5db093731b1b0119LL,  // atan(0.8984375) = 0.7319511711159165961691081923069698302312376920187798593908586491840240551583465079002551807314051455
    0x5df7444ba88b1d73LL,  // atan(0.90234375) = 0.7341084832597396927999810897813561563778462507681354027346173860239669126089086018089481609207951864
    0x5e3daef574c57940LL,  // atan(0.90625) = 0.7362574289814281317428352710891466628319679006871907518966859182573143622295611225561191493197177789
    0x5e83d3ae70668844LL,  // atan(0.91015625) = 0.7383980371239895554111814479755606444941406569019364290266475972332623326950284398368171380793114556
    0x5ec9b2b4b943f631LL,  // atan(0.9140625) = 0.7405303366126926909825420855291840454920836308834152330117264407281450259730414869534491522341395751
    0x5f0f4c469824adbbLL,  // atan(0.91796875) = 0.7426543564509179776554608249000207477314005185283352265121970700327348684793217119041535513433768405
    0x5f54a0a27e824d56LL,  // atan(0.921875) = 0.7447701257160751857639310909741182291100083141982366919548320952500743478911933638390032597786199637
    0x5f99b0070453f637LL,  // atan(0.92578125) = 0.7468776735555874906637353378326703200015110847150285136522440085596626977657682638950059015280462439
    0x5fde7ab2e5e261fdLL,  // atan(0.9296875) = 0.7489770291829414558452980730009161352346124330041331353346159499045656471872751427983812297493768032
    0x602300e501a52affLL,  // atan(0.93359375) = 0.7510682218738023717766117770551174557866016308627433127031225980271762117005993508643582006829779013
    0x606742dc56293320LL,  // atan(0.9375) = 0.7531512809621943895247393702690288816000939065209521727440816378470657937731136053991980161969413308
    0x60ab40d8000014a2LL,  // atan(0.94140625) = 0.7552262358367448812326032083852174468922169053691015431358628414081521421531874361008500347507110872
    0x60eefb1737b8884cLL,  // atan(0.9453125) = 0.7572931159369924530266468114325073269043421486150440953786290708008605394451083208815470963020061306
    0x613271d94fdfabf3LL,  // atan(0.94921875) = 0.759351950749758029888050083802174731435797652311840243611136068166769301150875548689783885677974804
    0x6175a55db30b145aLL,  // atan(0.953125) = 0.7614027698055784264231855420876226364336310712672545184625390565900891114673810904994008216049923062
    0x61b895e3e1eb9502LL,  // atan(0.95703125) = 0.7634456026752018123057660317131236856017140531798543160202607738599496297443190132676706499967167445
    0x61fb43ab7168a885LL,  // atan(0.9609375) = 0.7654804789661444764216520449312483128885287386263105775800184224539277289834623121880651868164144338
    0x623daef408c463d9LL,  // atan(0.96484375) = 0.7675074283193082894157159394099851523698582650312935783554030977204991919304841803284531366573411256
    0x627fd7fd5fc7deaaLL,  // atan(0.96875) = 0.7695264804056582604068200359856540188684794301066406539478976336525124825407895116020140983552775258
    0x62c1bf073cf7faf0LL,  // atan(0.97265625) = 0.7715376649229595800903400220773541836991084482022189748849212484728257677408641292358873267573840864
    0x6303645173d275beLL,  // atan(0.9765625) = 0.7735410115925735392764068852829523393120564557110984094530591823798410266402891157178803524459963655
    0x6344c81be3132b27LL,  // atan(0.98046875) = 0.7755365501563117091049732955865416609616107926292188254452997143755879695010809942296307647984900562
    0x6385eaa673017709LL,  // atan(0.984375) = 0.777524310373347766724930816122437324997826482100462687918237951295777935119855995457195767583016041
    0x63c6cc3113c59c77LL,  // atan(0.98828125) = 0.7795043220171863481129848258979314140517973363510260007390652866305237505736956116614016919066372064
    0x64076cfbbbc61d68LL,  // atan(0.9921875) = 0.7814766148726883079281840634961382904955384623120089764216906449023066031664470785437079106135480861
    0x6447cd46660cec4eLL,  // atan(0.99609375) = 0.7834412187331517648394294758877039800822981339788990735555216232598043220054349361607003085120119334
    0x6487ed5110b4611aLL   // atan(1.0) = 0.785398163397448309615660845819875721049292349843776455243736148076954101571552249657008706335529267
};

// Lookup atan(x) with cubic interpolation between table entries for better accuracy
inline constexpr int64_t LookupAtanCubic(int64_t x, int precision) {
    // Ensure x is in [0,1] range scaled by 2^precision
    if (x <= 0) return 0;
    
    const int64_t one = static_cast<int64_t>(1) << precision;
    if (x >= one) return AtanLUT[AtanLUT.size() - 1] >> (63 - precision);
    
    // Scale x to table index
    const int64_t scale = static_cast<int64_t>(AtanLUT.size() - 1);
    const int64_t idx_scaled = (x * scale) >> precision;
    const int index = static_cast<int>(idx_scaled);
    
    // Calculate fractional part for interpolation (keeping precision)
    const int64_t frac = (x * scale) - (idx_scaled << precision);
    const double t = static_cast<double>(frac) / (1LL << precision);
    
    // Get table values for interpolation (four points for cubic)
    const int64_t y0 = (index > 0) ? AtanLUT[index - 1] : 2 * AtanLUT[0] - AtanLUT[1];
    const int64_t y1 = AtanLUT[index];
    const int64_t y2 = AtanLUT[index + 1];
    const int64_t y3 = (static_cast<size_t>(index) + 2 < AtanLUT.size()) ? 
                   AtanLUT[index + 2] : 
                   2 * AtanLUT[AtanLUT.size() - 1] - AtanLUT[AtanLUT.size() - 2];
    
    // Cubic interpolation using Catmull-Rom spline
    double t2 = t * t;
    double t3 = t2 * t;
    
    // Catmull-Rom coefficients
    double a = (-0.5 * t3 + t2 - 0.5 * t);
    double b = (1.5 * t3 - 2.5 * t2 + 1.0);
    double c = (-1.5 * t3 + 2.0 * t2 + 0.5 * t);
    double d = (0.5 * t3 - 0.5 * t2);
    
    // Cubic interpolation formula
    int64_t result = static_cast<int64_t>(a * y0 + b * y1 + c * y2 + d * y3);
    
    // Return scaled to requested precision
    return result >> (63 - precision);
}

// Original linear interpolation version for performance-critical paths
inline constexpr int64_t LookupAtan(int64_t x, int precision) {
    // Ensure x is in [0,1] range scaled by 2^precision
    if (x <= 0)
        return 0;
    
    const int64_t one = static_cast<int64_t>(1) << precision;
    if (x >= one)
        return AtanLUT[AtanLUT.size() - 1] >> (63 - precision);
    
    // Scale x to table index
    const int64_t scale = static_cast<int64_t>(AtanLUT.size() - 1);
    const int64_t idx_scaled = (x * scale) >> precision;
    const int index = static_cast<int>(idx_scaled);
    
    // Get table values for interpolation
    const int64_t y0 = AtanLUT[index];
    const int64_t y1 = AtanLUT[index + 1];
    
    // Calculate fractional part for interpolation (keeping precision)
    const int64_t frac = (x * scale) - (idx_scaled << precision);
    
    // Linear interpolation
    int64_t result = y0 + ((y1 - y0) * frac >> precision);
    
    // Return scaled to requested precision
    return result >> (63 - precision);
}

} // namespace math::fp::detail